{\rtf1\deff0 \stshfdbch3\stshfloch2\stshfhich2\stshfbi1{\fonttbl{\f0\fcharset204 Calibri;}{\fbiminor\f1\fcharset204 Times New Roman;}{\fhiminor\f2\fcharset204 Calibri;}{\fdbminor\f3\fcharset204 Times New Roman;}{\f4\fcharset204 Cambria Math;}{\f5\fcharset204 / 22px Menlo;}}{\colortbl ;\red0\green0\blue255 ;\red15\green17\blue21 ;}{\*\defchp \fcs1\f1\fcs1\f1\hich\af2\loch\af2\dbch\af3\cgrid1\fs24}{\*\defpap \widctlpar}{\stylesheet {\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24 Normal;}{\*\cs1\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24 Default Paragraph Font;}{\*\cs2\sbasedon1\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24 Line Number;}{\*\cs3\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\ul\cf1 Hyperlink;}{\*\ts4\tsrowd\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\ql\tscellpaddfl3\tscellpaddl108\tscellpaddfb3\tscellpaddfr3\tscellpaddr108\tscellpaddft3\tsvertalt\cltxlrtb Normal Table;}{\*\ts5\tsrowd\sbasedon4\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\ql\trbrdrt\brdrs\brdrw10\trbrdrl\brdrs\brdrw10\trbrdrb\brdrs\brdrw10\trbrdrr\brdrs\brdrw10\trbrdrh\brdrs\brdrw10\trbrdrv\brdrs\brdrw10\tscellpaddfl3\tscellpaddl108\tscellpaddfr3\tscellpaddr108\tsvertalt\cltxlrtb Table Simple 1;}}{\*\listoverridetable}{\*\generator DevExpress Office File API/25.1.3.0}{\info{\operator}{\creatim\yr2025\mo12\dy9\hr20\min30}{\revtim\yr2025\mo12\dy9\hr20\min41}{\version1}}{\mmathPr\mbrkBin0\mbrkBinSub0\mdefJc1\minterSp0\mintLim1\mintraSp0\mmathFont4\mnaryLim1\mpostSp0\mpreSp0\mrMargin0\msmallFrac0\mwrapIndent0\mwrapRight0}\htmautsp\sectd\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: ScanItemRequest.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.dto;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class ScanItemRequest \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String productId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String barcode;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Integer quantity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String location;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Boolean forceScan;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getProductId() \{ return productId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setProductId(String productId) \{ this.productId = productId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getBarcode() \{ return barcode; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setBarcode(String barcode) \{ this.barcode = barcode; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Integer getQuantity() \{ return quantity; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setQuantity(Integer quantity) \{ this.quantity = quantity; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getLocation() \{ return location; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setLocation(String location) \{ this.location = location; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Boolean getForceScan() \{ return forceScan; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setForceScan(Boolean forceScan) \{ this.forceScan = forceScan; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: ProductServiceClient.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.client;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.cloud.openfeign.FeignClient;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.web.bind.annotation.*;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Map;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @FeignClient(name = "product-service", url = "$\{services.product.url\}")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public interface ProductServiceClient \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/api/products/check-stock")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> checkStock(@RequestBody Map<String, Object> request);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/api/products/reserve")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> reserveProducts(@RequestBody Map<String, Object> request);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/api/products/release")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> releaseReservation(@RequestBody Map<String, Object> request);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @GetMapping("/api/products/\{productId\}/availability")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> getProductAvailability(@PathVariable String productId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: TransactionResponse.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.dto;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.enums.TransactionStatus;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.fasterxml.jackson.annotation.JsonInclude;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Map;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @JsonInclude(JsonInclude.Include.NON_NULL)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class TransactionResponse \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String transactionId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String orderId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String collectorId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String clientId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private TransactionStatus status;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String statusDescription;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Map<String, Integer> scannedItems;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Map<String, Integer> missingItems;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Map<String, Object> metadata;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String pauseReason;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: SagaStepEntity.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.entity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.converter.StringToStringConverter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.enums.SagaStepType;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.hibernate.annotations.CreationTimestamp;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import jakarta.persistence.*;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Entity}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Table(name = "saga_steps")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class SagaStepEntity \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Id}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @GeneratedValue(strategy = GenerationType.IDENTITY)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "id")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Long id;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "transaction_id", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String transactionId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Enumerated(EnumType.STRING)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "step_type", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private SagaStepType stepType;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "step_order", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Integer stepOrder;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "status", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String status; // PENDING, IN_PROGRESS, COMPLETED, FAILED, COMPENSATED, SKIPPED}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Convert(converter = StringToStringConverter.class)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "step_data", columnDefinition = "text")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String stepData;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Convert(converter = StringToStringConverter.class)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "compensation_data", columnDefinition = "text")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String compensationData;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "error_message", length = 2000)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String errorMessage;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "retry_count")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Integer retryCount = 0;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "max_retries")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Integer maxRetries = 3;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "retry_delay_minutes")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Integer retryDelayMinutes = 5;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "next_retry_time")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime nextRetryTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @CreationTimestamp}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "created_at", updatable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime createdAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "started_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime startedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "completed_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime completedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "compensated_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime compensatedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "duration_ms")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Long durationMs;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "is_compensatable")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Boolean isCompensatable = true;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "depends_on_step_id")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Long dependsOnStepId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // === \u1050\'ca\u1086\'ee\u1085\'ed\u1089\'f1\u1090\'f2\u1088\'f0\u1091\'f3\u1082\'ea\u1090\'f2\u1086\'ee\u1088\'f0\u1099\'fb ===}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public SagaStepEntity() \{\}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public SagaStepEntity(String transactionId, SagaStepType stepType, String status) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.transactionId = transactionId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.stepType = stepType;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.status = status;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.createdAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // === \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb ===}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Long getId() \{ return id; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setId(Long id) \{ this.id = id; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getTransactionId() \{ return transactionId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setTransactionId(String transactionId) \{ this.transactionId = transactionId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1042\'c2\u1086\'ee\u1079\'e7\u1074\'e2\u1088\'f0\u1072\'e0\u1097\'f9\u1072\'e0\u1077\'e5\u1090\'f2 \u1089\'f1\u1090\'f2\u1088\'f0\u1086\'ee\u1082\'ea\u1086\'ee\u1074\'e2\u1086\'ee\u1077\'e5 \u1087\'ef\u1088\'f0\u1077\'e5\u1076\'e4\u1089\'f1\u1090\'f2\u1072\'e0\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 enum}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getStepType() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return stepType != null ? stepType.name() : "";}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1042\'c2\u1086\'ee\u1079\'e7\u1074\'e2\u1088\'f0\u1072\'e0\u1097\'f9\u1072\'e0\u1077\'e5\u1090\'f2 enum}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public SagaStepType getStepTypeEnum() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return stepType;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStepType(SagaStepType stepType) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.stepType = stepType;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1059\'d3\u1089\'f1\u1090\'f2\u1072\'e0\u1085\'ed\u1086\'ee\u1074\'e2\u1082\'ea\u1072\'e0 \u1080\'e8\u1079\'e7 \u1089\'f1\u1090\'f2\u1088\'f0\u1086\'ee\u1082\'ea\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStepTypeFromString(String stepTypeStr) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         try \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             this.stepType = SagaStepType.valueOf(stepTypeStr);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \} catch (IllegalArgumentException e) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             this.stepType = null;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Integer getStepOrder() \{ return stepOrder; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStepOrder(Integer stepOrder) \{ this.stepOrder = stepOrder; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getStatus() \{ return status; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStatus(String status) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.status = status;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if ("IN_PROGRESS".equals(status) && this.startedAt == null) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             this.startedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \} else if ("COMPLETED".equals(status) || "FAILED".equals(status) || "COMPENSATED".equals(status)) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             this.completedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             if (this.startedAt != null) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 this.durationMs = java.time.Duration.between(this.startedAt, this.completedAt).toMillis();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getStepData() \{ return stepData; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStepData(String stepData) \{ this.stepData = stepData; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getCompensationData() \{ return compensationData; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCompensationData(String compensationData) \{ this.compensationData = compensationData; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getErrorMessage() \{ return errorMessage; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setErrorMessage(String errorMessage) \{ this.errorMessage = errorMessage; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Integer getRetryCount() \{ return retryCount; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setRetryCount(Integer retryCount) \{ this.retryCount = retryCount; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Integer getMaxRetries() \{ return maxRetries; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setMaxRetries(Integer maxRetries) \{ this.maxRetries = maxRetries; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Integer getRetryDelayMinutes() \{ return retryDelayMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setRetryDelayMinutes(Integer retryDelayMinutes) \{ this.retryDelayMinutes = retryDelayMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getNextRetryTime() \{ return nextRetryTime; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setNextRetryTime(LocalDateTime nextRetryTime) \{ this.nextRetryTime = nextRetryTime; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getCreatedAt() \{ return createdAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCreatedAt(LocalDateTime createdAt) \{ this.createdAt = createdAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getStartedAt() \{ return startedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStartedAt(LocalDateTime startedAt) \{ this.startedAt = startedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getCompletedAt() \{ return completedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCompletedAt(LocalDateTime completedAt) \{ this.completedAt = completedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getCompensatedAt() \{ return compensatedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCompensatedAt(LocalDateTime compensatedAt) \{ this.compensatedAt = compensatedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Long getDurationMs() \{ return durationMs; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setDurationMs(Long durationMs) \{ this.durationMs = durationMs; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Boolean getIsCompensatable() \{ return isCompensatable; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setIsCompensatable(Boolean isCompensatable) \{ this.isCompensatable = isCompensatable; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Long getDependsOnStepId() \{ return dependsOnStepId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setDependsOnStepId(Long dependsOnStepId) \{ this.dependsOnStepId = dependsOnStepId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // === \u1042\'c2\u1089\'f1\u1087\'ef\u1086\'ee\u1084\'ec\u1086\'ee\u1075\'e3\u1072\'e0\u1090\'f2\u1077\'e5\u1083\'eb\u1100\'fc\u1085\'ed\u1099\'fb\u1077\'e5 \u1084\'ec\u1077\'e5\u1090\'f2\u1086\'ee\u1076\'e4\u1099\'fb ===}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void incrementRetryCount() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (this.retryCount == null) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             this.retryCount = 0;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.retryCount++;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.nextRetryTime = LocalDateTime.now().plusMinutes(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 this.retryDelayMinutes != null ? this.retryDelayMinutes : 5}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         );}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean canRetry() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (this.retryCount == null) this.retryCount = 0;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (this.maxRetries == null) this.maxRetries = 3;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (this.status == null) this.status = "PENDING";}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return this.retryCount < this.maxRetries &&}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 ("FAILED".equals(this.status) || "PENDING".equals(this.status));}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean shouldRetryNow() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (!canRetry()) return false;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (this.nextRetryTime == null) return true;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return LocalDateTime.now().isAfter(this.nextRetryTime);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isPending() \{ return "PENDING".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isInProgress() \{ return "IN_PROGRESS".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isCompleted() \{ return "COMPLETED".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isFailed() \{ return "FAILED".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isCompensated() \{ return "COMPENSATED".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isSkipped() \{ return "SKIPPED".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void markAsCompensated() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.status = "COMPENSATED";}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.compensatedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void markAsSkipped() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.status = "SKIPPED";}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.completedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: StringToStringConverter.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.converter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import jakarta.persistence.AttributeConverter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import jakarta.persistence.Converter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Converter}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class StringToStringConverter implements AttributeConverter<String, String> \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Override}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String convertToDatabaseColumn(String attribute) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return attribute == null ? "" : attribute;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Override}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String convertToEntityAttribute(String dbData) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return dbData == null ? "" : dbData;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: ProblemReportRequest.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.dto;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class ProblemReportRequest \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String problemType;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String productId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Integer quantity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String description;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String location;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String collectorNotes;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String imageUrl;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getProblemType() \{ return problemType; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setProblemType(String problemType) \{ this.problemType = problemType; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getProductId() \{ return productId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setProductId(String productId) \{ this.productId = productId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Integer getQuantity() \{ return quantity; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setQuantity(Integer quantity) \{ this.quantity = quantity; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getDescription() \{ return description; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setDescription(String description) \{ this.description = description; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getLocation() \{ return location; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setLocation(String location) \{ this.location = location; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getCollectorNotes() \{ return collectorNotes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCollectorNotes(String collectorNotes) \{ this.collectorNotes = collectorNotes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getImageUrl() \{ return imageUrl; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setImageUrl(String imageUrl) \{ this.imageUrl = imageUrl; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: CompensationLogEntity.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.entity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.converter.StringToStringConverter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.hibernate.annotations.CreationTimestamp;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import jakarta.persistence.*;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Entity}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Table(name = "compensation_logs")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class CompensationLogEntity \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Id}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @GeneratedValue(strategy = GenerationType.IDENTITY)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "id")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Long id;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "transaction_id", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String transactionId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "saga_step_id")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Long sagaStepId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "compensation_type", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String compensationType; // FULL, PARTIAL, ITEM_SPECIFIC}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "reason", nullable = false, length = 1000)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String reason;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Convert(converter = StringToStringConverter.class)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "compensated_items", columnDefinition = "text")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String compensatedItems; // JSON \u1089\'f1\u1087\'ef\u1080\'e8\u1089\'f1\u1086\'ee\u1082\'ea \u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1086\'ee\u1074\'e2 \u1076\'e4\u1083\'eb\u1103\'ff \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "status", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String status; // PENDING, IN_PROGRESS, COMPLETED, FAILED}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "retry_count")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Integer retryCount = 0;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "error_message", length = 2000)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String errorMessage;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @CreationTimestamp}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "created_at", updatable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime createdAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "started_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime startedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "completed_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime completedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "duration_ms")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Long durationMs;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Convert(converter = StringToStringConverter.class)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "compensation_data", columnDefinition = "text")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String compensationData; // JSON \u1076\'e4\u1086\'ee\u1087\'ef\u1086\'ee\u1083\'eb\u1085\'ed\u1080\'e8\u1090\'f2\u1077\'e5\u1083\'eb\u1100\'fc\u1085\'ed\u1099\'fb\u1077\'e5 \u1076\'e4\u1072\'e0\u1085\'ed\u1085\'ed\u1099\'fb\u1077\'e5}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Long getId() \{ return id; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setId(Long id) \{ this.id = id; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getTransactionId() \{ return transactionId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setTransactionId(String transactionId) \{ this.transactionId = transactionId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Long getSagaStepId() \{ return sagaStepId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setSagaStepId(Long sagaStepId) \{ this.sagaStepId = sagaStepId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getCompensationType() \{ return compensationType; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCompensationType(String compensationType) \{ this.compensationType = compensationType; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getReason() \{ return reason; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setReason(String reason) \{ this.reason = reason; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getCompensatedItems() \{ return compensatedItems; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCompensatedItems(String compensatedItems) \{ this.compensatedItems = compensatedItems; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getStatus() \{ return status; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStatus(String status) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.status = status;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if ("IN_PROGRESS".equals(status) && this.startedAt == null) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             this.startedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \} else if ("COMPLETED".equals(status) || "FAILED".equals(status)) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             this.completedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             if (this.startedAt != null) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 this.durationMs = java.time.Duration.between(this.startedAt, this.completedAt).toMillis();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Integer getRetryCount() \{ return retryCount; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setRetryCount(Integer retryCount) \{ this.retryCount = retryCount; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getErrorMessage() \{ return errorMessage; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setErrorMessage(String errorMessage) \{ this.errorMessage = errorMessage; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getCreatedAt() \{ return createdAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCreatedAt(LocalDateTime createdAt) \{ this.createdAt = createdAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getStartedAt() \{ return startedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStartedAt(LocalDateTime startedAt) \{ this.startedAt = startedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getCompletedAt() \{ return completedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCompletedAt(LocalDateTime completedAt) \{ this.completedAt = completedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Long getDurationMs() \{ return durationMs; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setDurationMs(Long durationMs) \{ this.durationMs = durationMs; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getCompensationData() \{ return compensationData; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCompensationData(String compensationData) \{ this.compensationData = compensationData; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1042\'c2\u1089\'f1\u1087\'ef\u1086\'ee\u1084\'ec\u1086\'ee\u1075\'e3\u1072\'e0\u1090\'f2\u1077\'e5\u1083\'eb\u1100\'fc\u1085\'ed\u1099\'fb\u1077\'e5 \u1084\'ec\u1077\'e5\u1090\'f2\u1086\'ee\u1076\'e4\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isPending() \{ return "PENDING".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isInProgress() \{ return "IN_PROGRESS".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isCompleted() \{ return "COMPLETED".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isFailed() \{ return "FAILED".equals(this.status); \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void incrementRetryCount() \{ this.retryCount++; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: SagaController.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.controller;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.entity.SagaStepEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.repository.SagaStepRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.beans.factory.annotation.Autowired;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.http.ResponseEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.web.bind.annotation.*;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.List;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @RestController}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @RequestMapping("/api/saga")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class SagaController \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private final SagaStepRepository sagaStepRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Autowired}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public SagaController(SagaStepRepository sagaStepRepository) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.sagaStepRepository = sagaStepRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @GetMapping("/steps/\{transactionId\}")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public ResponseEntity<List<SagaStepEntity>> getTransactionSteps(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @PathVariable String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         List<SagaStepEntity> steps = sagaStepRepository.findByTransactionId(transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return ResponseEntity.ok(steps);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/steps/\{stepId\}/retry")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public ResponseEntity<String> retryStep(@PathVariable Long stepId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         SagaStepEntity step = sagaStepRepository.findById(stepId)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 .orElseThrow(() -> new RuntimeException("Step not found"));}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (step.canRetry()) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             step.setStatus("PENDING");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             step.incrementRetryCount();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             sagaStepRepository.save(step);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             return ResponseEntity.ok("Step queued for retry");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return ResponseEntity.badRequest().body("Step cannot be retried");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @GetMapping("/health")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public ResponseEntity<String> healthCheck() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return ResponseEntity.ok("Saga orchestrator is running");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: ExternalServiceClient.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.client;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.slf4j.Logger;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.slf4j.LoggerFactory;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.beans.factory.annotation.Autowired;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.stereotype.Component;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Map;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Component}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class ExternalServiceClient \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private static final Logger log = LoggerFactory.getLogger(ExternalServiceClient.class);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void validateOrder(String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Validating order for transaction: \{\}", transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void checkStock(String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Checking stock for transaction: \{\}", transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void notifyOffice(String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Notifying office about transaction: \{\}", transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void notifyCollector(String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Notifying collector about transaction: \{\}", transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void reserveItems(String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Reserving items for transaction: \{\}", transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void updateTransactionStatus(String transactionId, String status) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Updating transaction \{\} status to: \{\}", transactionId, status);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void logAuditEvent(String transactionId, String eventType, String details) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Audit event: transaction=\{\}, event=\{\}, details=\{\}",}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 transactionId, eventType, details);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1053\'cd\u1086\'ee\u1074\'e2\u1099\'fb\u1077\'e5 \u1084\'ec\u1077\'e5\u1090\'f2\u1086\'ee\u1076\'e4\u1099\'fb \u1076\'e4\u1083\'eb\u1103\'ff \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void cancelReservations(String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Cancelling reservations for transaction: \{\}", transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void notifyCollectorAboutCancellation(String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Notifying collector about cancellation for transaction: \{\}", transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void processRefund(String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         log.info("Processing refund for transaction: \{\}", transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: TransactionStatus.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.entity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public enum TransactionStatus \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     CREATED,        // \u1058\'d2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1103\'ff \u1089\'f1\u1086\'ee\u1079\'e7\u1076\'e4\u1072\'e0\u1085\'ed\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     ACTIVE,         // \u1042\'c2 \u1087\'ef\u1088\'f0\u1086\'ee\u1094\'f6\u1077\'e5\u1089\'f1\u1089\'f1\u1077\'e5 \u1089\'f1\u1073\'e1\u1086\'ee\u1088\'f0\u1082\'ea\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     PAUSED,         // \u1055\'cf\u1088\'f0\u1080\'e8\u1086\'ee\u1089\'f1\u1090\'f2\u1072\'e0\u1085\'ed\u1086\'ee\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1072\'e0 (\u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1072\'e0 \u1085\'ed\u1077\'e5\u1090\'f2)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     WAITING_CLIENT, // \u1054\'ce\u1078\'e6\u1080\'e8\u1076\'e4\u1072\'e0\u1085\'ed\u1080\'e8\u1077\'e5 \u1088\'f0\u1077\'e5\u1096\'f8\u1077\'e5\u1085\'ed\u1080\'e8\u1103\'ff \u1082\'ea\u1083\'eb\u1080\'e8\u1077\'e5\u1085\'ed\u1090\'f2\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     WAITING_OFFICE, // \u1054\'ce\u1078\'e6\u1080\'e8\u1076\'e4\u1072\'e0\u1085\'ed\u1080\'e8\u1077\'e5 \u1086\'ee\u1073\'e1\u1088\'f0\u1072\'e0\u1073\'e1\u1086\'ee\u1090\'f2\u1082\'ea\u1080\'e8 \u1086\'ee\u1092\'f4\u1080\'e8\u1089\'f1\u1086\'ee\u1084\'ec}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     COMPENSATING,   // \u1042\'c2 \u1087\'ef\u1088\'f0\u1086\'ee\u1094\'f6\u1077\'e5\u1089\'f1\u1089\'f1\u1077\'e5 \u1086\'ee\u1090\'f2\u1082\'ea\u1072\'e0\u1090\'f2\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     COMPLETED,      // \u1059\'d3\u1089\'f1\u1087\'ef\u1077\'e5\u1096\'f8\u1085\'ed\u1086\'ee \u1079\'e7\u1072\'e0\u1074\'e2\u1077\'e5\u1088\'f0\u1096\'f8\u1077\'e5\u1085\'ed\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     CANCELLED,      // \u1054\'ce\u1090\'f2\u1084\'ec\u1077\'e5\u1085\'ed\u1077\'e5\u1085\'ed\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     TIMEOUT         // \u1055\'cf\u1088\'f0\u1086\'ee\u1089\'f1\u1088\'f0\u1086\'ee\u1095\'f7\u1077\'e5\u1085\'ed\u1072\'e0 \u1087\'ef\u1086\'ee \u1090\'f2\u1072\'e0\u1081\'e9\u1084\'ec\u1072\'e0\u1091\'f3\u1090\'f2\u1091\'f3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: OfficeServiceClient.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.client;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.cloud.openfeign.FeignClient;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.web.bind.annotation.*;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Map;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @FeignClient(name = "office-service", url = "$\{services.office.url\}")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public interface OfficeServiceClient \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/api/office/notify-problem")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> notifyOfficeAboutProblem(@RequestBody Map<String, Object> request);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/api/office/client-notification")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> notifyClient(@RequestBody Map<String, Object> notification);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @GetMapping("/api/office/check-availability/\{productId\}")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> checkProductAvailability(@PathVariable String productId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: TransactionEntity.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.entity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.converter.MapToStringConverter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.converter.ObjectToStringConverter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.enums.TransactionStatus;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.hibernate.annotations.CreationTimestamp;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.hibernate.annotations.UpdateTimestamp;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.enums.TransactionStatus;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import jakarta.persistence.*;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.HashMap;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Map;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.UUID;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Entity}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Table(name = "transactions")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class TransactionEntity \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Id}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "id", nullable = false, updatable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String id = UUID.randomUUID().toString();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "order_id", nullable = false, unique = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String orderId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "collector_id", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String collectorId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "client_id", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String clientId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Enumerated(EnumType.STRING)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "status", nullable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private TransactionStatus status = TransactionStatus.CREATED;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Convert(converter = MapToStringConverter.class)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "scanned_items", columnDefinition = "jsonb")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Map<String, Integer> scannedItems = new HashMap<>();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Convert(converter = MapToStringConverter.class)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "missing_items", columnDefinition = "jsonb")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Map<String, Integer> missingItems = new HashMap<>();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Convert(converter = ObjectToStringConverter.class)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "metadata", columnDefinition = "jsonb")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Map<String, Object> metadata = new HashMap<>();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "pause_reason", length = 1000)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String pauseReason;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "client_decision", length = 50)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String clientDecision;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "office_notes", length = 2000)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String officeNotes;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "office_problem_id")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Long officeProblemId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "timeout_minutes")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Integer timeoutMinutes = 1440;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "estimated_completion_time")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime estimatedCompletionTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @CreationTimestamp}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "created_at", updatable = false)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime createdAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @UpdateTimestamp}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "updated_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime updatedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "started_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime startedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "paused_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime pausedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "client_notified_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime clientNotifiedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "client_responded_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime clientRespondedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "resumed_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime resumedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "completed_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime completedAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "cancelled_at")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime cancelledAt;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Version}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Column(name = "version")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Long version;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1050\'ca\u1086\'ee\u1085\'ed\u1089\'f1\u1090\'f2\u1088\'f0\u1091\'f3\u1082\'ea\u1090\'f2\u1086\'ee\u1088\'f0\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public TransactionEntity() \{\}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public TransactionEntity(String orderId, String collectorId, String clientId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.orderId = orderId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.collectorId = collectorId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.clientId = clientId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.startedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.estimatedCompletionTime = LocalDateTime.now().plusMinutes(30);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getId() \{ return id; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setId(String id) \{ this.id = id; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getOrderId() \{ return orderId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setOrderId(String orderId) \{ this.orderId = orderId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getCollectorId() \{ return collectorId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCollectorId(String collectorId) \{ this.collectorId = collectorId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getClientId() \{ return clientId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setClientId(String clientId) \{ this.clientId = clientId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public TransactionStatus getStatus() \{ return status; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStatus(TransactionStatus status) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.status = status;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.updatedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Map<String, Integer> getScannedItems() \{ return scannedItems; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setScannedItems(Map<String, Integer> scannedItems) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.scannedItems = scannedItems != null ? scannedItems : new HashMap<>();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Map<String, Integer> getMissingItems() \{ return missingItems; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setMissingItems(Map<String, Integer> missingItems) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.missingItems = missingItems != null ? missingItems : new HashMap<>();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Map<String, Object> getMetadata() \{ return metadata; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setMetadata(Map<String, Object> metadata) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.metadata = metadata != null ? metadata : new HashMap<>();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getPauseReason() \{ return pauseReason; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setPauseReason(String pauseReason) \{ this.pauseReason = pauseReason; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getClientDecision() \{ return clientDecision; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setClientDecision(String clientDecision) \{ this.clientDecision = clientDecision; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getOfficeNotes() \{ return officeNotes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setOfficeNotes(String officeNotes) \{ this.officeNotes = officeNotes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Long getOfficeProblemId() \{ return officeProblemId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setOfficeProblemId(Long officeProblemId) \{ this.officeProblemId = officeProblemId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Integer getTimeoutMinutes() \{ return timeoutMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setTimeoutMinutes(Integer timeoutMinutes) \{ this.timeoutMinutes = timeoutMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getEstimatedCompletionTime() \{ return estimatedCompletionTime; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setEstimatedCompletionTime(LocalDateTime estimatedCompletionTime) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.estimatedCompletionTime = estimatedCompletionTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getCreatedAt() \{ return createdAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCreatedAt(LocalDateTime createdAt) \{ this.createdAt = createdAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getUpdatedAt() \{ return updatedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setUpdatedAt(LocalDateTime updatedAt) \{ this.updatedAt = updatedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getStartedAt() \{ return startedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setStartedAt(LocalDateTime startedAt) \{ this.startedAt = startedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getPausedAt() \{ return pausedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setPausedAt(LocalDateTime pausedAt) \{ this.pausedAt = pausedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getClientNotifiedAt() \{ return clientNotifiedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setClientNotifiedAt(LocalDateTime clientNotifiedAt) \{ this.clientNotifiedAt = clientNotifiedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getClientRespondedAt() \{ return clientRespondedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setClientRespondedAt(LocalDateTime clientRespondedAt) \{ this.clientRespondedAt = clientRespondedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getResumedAt() \{ return resumedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setResumedAt(LocalDateTime resumedAt) \{ this.resumedAt = resumedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getCompletedAt() \{ return completedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCompletedAt(LocalDateTime completedAt) \{ this.completedAt = completedAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getCancelledAt() \{ return cancelledAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCancelledAt(LocalDateTime cancelledAt) \{ this.cancelledAt = cancelledAt; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Long getVersion() \{ return version; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setVersion(Long version) \{ this.version = version; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1042\'c2\u1089\'f1\u1087\'ef\u1086\'ee\u1084\'ec\u1086\'ee\u1075\'e3\u1072\'e0\u1090\'f2\u1077\'e5\u1083\'eb\u1100\'fc\u1085\'ed\u1099\'fb\u1077\'e5 \u1084\'ec\u1077\'e5\u1090\'f2\u1086\'ee\u1076\'e4\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isActive() \{ return status == TransactionStatus.ACTIVE; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isPaused() \{ return status == TransactionStatus.PAUSED; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isWaitingForClient() \{ return status == TransactionStatus.WAITING_CLIENT; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isWaitingForOffice() \{ return status == TransactionStatus.WAITING_OFFICE; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isCompensating() \{ return status == TransactionStatus.COMPENSATING; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isCompleted() \{ return status == TransactionStatus.COMPLETED; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isCancelled() \{ return status == TransactionStatus.CANCELLED; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isTimeout() \{ return status == TransactionStatus.TIMEOUT; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void addScannedItem(String productId, int quantity) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.scannedItems.merge(productId, quantity, Integer::sum);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.updatedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void addMissingItem(String productId, int quantity) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.missingItems.put(productId, quantity);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.updatedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void removeMissingItem(String productId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.missingItems.remove(productId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.updatedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean hasMissingItems() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return !this.missingItems.isEmpty();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public int getTotalScannedQuantity() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return this.scannedItems.values().stream().mapToInt(Integer::intValue).sum();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public int getTotalMissingQuantity() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return this.missingItems.values().stream().mapToInt(Integer::intValue).sum();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void addMetadata(String key, Object value) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.metadata.put(key, value);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.updatedAt = LocalDateTime.now();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Object getMetadata(String key) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return this.metadata.get(key);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public boolean isTimedOut() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (this.clientNotifiedAt == null) return false;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         LocalDateTime timeoutThreshold = this.clientNotifiedAt.plusMinutes(this.timeoutMinutes);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return LocalDateTime.now().isAfter(timeoutThreshold);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public long getRemainingTimeoutMinutes() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (this.clientNotifiedAt == null) return this.timeoutMinutes;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         LocalDateTime timeoutTime = this.clientNotifiedAt.plusMinutes(this.timeoutMinutes);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return java.time.Duration.between(LocalDateTime.now(), timeoutTime).toMinutes();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: ClientDecisionRequest.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.dto;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.List;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class ClientDecisionRequest \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String decision;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String notes;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String clientId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private List<String> substituteProducts;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Boolean requestRefund;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String refundReason;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getDecision() \{ return decision; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setDecision(String decision) \{ this.decision = decision; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getNotes() \{ return notes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setNotes(String notes) \{ this.notes = notes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getClientId() \{ return clientId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setClientId(String clientId) \{ this.clientId = clientId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public List<String> getSubstituteProducts() \{ return substituteProducts; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setSubstituteProducts(List<String> substituteProducts) \{ this.substituteProducts = substituteProducts; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Boolean getRequestRefund() \{ return requestRefund; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setRequestRefund(Boolean requestRefund) \{ this.requestRefund = requestRefund; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getRefundReason() \{ return refundReason; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setRefundReason(String refundReason) \{ this.refundReason = refundReason; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: CompensationController.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.controller;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.entity.CompensationLogEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.service.CompensationService;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.beans.factory.annotation.Autowired;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.http.ResponseEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.web.bind.annotation.*;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.List;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @RestController}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @RequestMapping("/api/compensation")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class CompensationController \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private final CompensationService compensationService;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Autowired}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public CompensationController(CompensationService compensationService) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.compensationService = compensationService;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/\{transactionId\}/initiate")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public ResponseEntity<String> initiateCompensation(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @PathVariable String transactionId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @RequestParam String reason,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @RequestParam(required = false) String details) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensationService.initiateCompensation(transactionId, reason, details);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return ResponseEntity.ok("Compensation initiated");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @GetMapping("/history/\{transactionId\}")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public ResponseEntity<List<CompensationLogEntity>> getCompensationHistory(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @PathVariable String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         List<CompensationLogEntity> history =}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 compensationService.getCompensationHistory(transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return ResponseEntity.ok(history);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: MapToStringConverter.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.converter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.fasterxml.jackson.core.JsonProcessingException;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.fasterxml.jackson.core.type.TypeReference;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.fasterxml.jackson.databind.ObjectMapper;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import jakarta.persistence.AttributeConverter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import jakarta.persistence.Converter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.io.IOException;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.HashMap;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Map;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Converter}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class MapToStringConverter implements AttributeConverter<Map<String, Integer>, String> \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private static final ObjectMapper objectMapper = new ObjectMapper();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Override}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String convertToDatabaseColumn(Map<String, Integer> attribute) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         try \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             return attribute == null || attribute.isEmpty() ? "\{\}" :}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                     objectMapper.writeValueAsString(attribute);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \} catch (JsonProcessingException e) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             return "\{\}";}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Override}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Map<String, Integer> convertToEntityAttribute(String dbData) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         try \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             return dbData == null || dbData.isEmpty() || "\{\}".equals(dbData) ?}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                     new HashMap<>() :}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                     objectMapper.readValue(dbData, new TypeReference<Map<String, Integer>>() \{\});}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \} catch (IOException e) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             return new HashMap<>();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: CollectorServiceClient.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.client;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.cloud.openfeign.FeignClient;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.web.bind.annotation.*;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Map;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @FeignClient(name = "collector-service", url = "$\{services.collector.url\}")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public interface CollectorServiceClient \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/api/collector/tasks")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> createTask(@RequestBody Map<String, Object> task);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PutMapping("/api/collector/tasks/\{taskId\}/status")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> updateTaskStatus(@PathVariable String taskId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                                          @RequestParam String status);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/api/collector/notify")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> notifyCollector(@RequestBody Map<String, Object> notification);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @PostMapping("/api/collector/cancel-task")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Map<String, Object> cancelTask(@RequestBody Map<String, Object> request);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: TransactionRequest.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.dto;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.List;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class TransactionRequest \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String orderId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String collectorId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String clientId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private List<OrderItemRequest> items;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Integer timeoutMinutes;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String priority;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private String notes;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getOrderId() \{ return orderId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setOrderId(String orderId) \{ this.orderId = orderId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getCollectorId() \{ return collectorId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCollectorId(String collectorId) \{ this.collectorId = collectorId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getClientId() \{ return clientId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setClientId(String clientId) \{ this.clientId = clientId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public List<OrderItemRequest> getItems() \{ return items; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setItems(List<OrderItemRequest> items) \{ this.items = items; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Integer getTimeoutMinutes() \{ return timeoutMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setTimeoutMinutes(Integer timeoutMinutes) \{ this.timeoutMinutes = timeoutMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getPriority() \{ return priority; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setPriority(String priority) \{ this.priority = priority; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String getNotes() \{ return notes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setNotes(String notes) \{ this.notes = notes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public static class OrderItemRequest \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private String productId;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private String productName;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private Integer quantity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private Double price;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private String location;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private String barcode;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public String getProductId() \{ return productId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setProductId(String productId) \{ this.productId = productId; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public String getProductName() \{ return productName; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setProductName(String productName) \{ this.productName = productName; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public Integer getQuantity() \{ return quantity; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setQuantity(Integer quantity) \{ this.quantity = quantity; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public Double getPrice() \{ return price; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setPrice(Double price) \{ this.price = price; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public String getLocation() \{ return location; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setLocation(String location) \{ this.location = location; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public String getBarcode() \{ return barcode; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setBarcode(String barcode) \{ this.barcode = barcode; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: SagaProperties.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.config;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.boot.context.properties.ConfigurationProperties;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.context.annotation.Configuration;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Configuration}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @ConfigurationProperties(prefix = "saga")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class SagaProperties \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Retry retry = new Retry();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Timeout timeout = new Timeout();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Cleanup cleanup = new Cleanup();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private Batch batch = new Batch();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public static class Retry \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private int maxAttempts = 3;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private int delayMinutes = 5;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private int maxDelayMinutes = 60;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         // \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public int getMaxAttempts() \{ return maxAttempts; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setMaxAttempts(int maxAttempts) \{ this.maxAttempts = maxAttempts; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public int getDelayMinutes() \{ return delayMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setDelayMinutes(int delayMinutes) \{ this.delayMinutes = delayMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public int getMaxDelayMinutes() \{ return maxDelayMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setMaxDelayMinutes(int maxDelayMinutes) \{ this.maxDelayMinutes = maxDelayMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public static class Timeout \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private int defaultMinutes = 1440; // 24 \u1095\'f7\u1072\'e0\u1089\'f1\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private int clientResponseMinutes = 120; // 2 \u1095\'f7\u1072\'e0\u1089\'f1\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         // \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public int getDefaultMinutes() \{ return defaultMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setDefaultMinutes(int defaultMinutes) \{ this.defaultMinutes = defaultMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public int getClientResponseMinutes() \{ return clientResponseMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setClientResponseMinutes(int clientResponseMinutes) \{ this.clientResponseMinutes = clientResponseMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public static class Cleanup \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private int completedTransactionsHours = 24;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private int failedTransactionsHours = 72;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         // \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public int getCompletedTransactionsHours() \{ return completedTransactionsHours; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setCompletedTransactionsHours(int completedTransactionsHours) \{ this.completedTransactionsHours = completedTransactionsHours; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public int getFailedTransactionsHours() \{ return failedTransactionsHours; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setFailedTransactionsHours(int failedTransactionsHours) \{ this.failedTransactionsHours = failedTransactionsHours; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public static class Batch \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private int size = 50;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         private long delayMs = 1000;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         // \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public int getSize() \{ return size; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setSize(int size) \{ this.size = size; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public long getDelayMs() \{ return delayMs; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         public void setDelayMs(long delayMs) \{ this.delayMs = delayMs; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1076\'e4\u1083\'eb\u1103\'ff \u1075\'e3\u1083\'eb\u1072\'e0\u1074\'e2\u1085\'ed\u1086\'ee\u1075\'e3\u1086\'ee \u1082\'ea\u1083\'eb\u1072\'e0\u1089\'f1\u1089\'f1\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Retry getRetry() \{ return retry; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setRetry(Retry retry) \{ this.retry = retry; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Timeout getTimeout() \{ return timeout; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setTimeout(Timeout timeout) \{ this.timeout = timeout; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Cleanup getCleanup() \{ return cleanup; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCleanup(Cleanup cleanup) \{ this.cleanup = cleanup; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Batch getBatch() \{ return batch; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setBatch(Batch batch) \{ this.batch = batch; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: ObjectToStringConverter.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.converter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.fasterxml.jackson.core.JsonProcessingException;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.fasterxml.jackson.databind.ObjectMapper;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import jakarta.persistence.AttributeConverter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import jakarta.persistence.Converter;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.io.IOException;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.HashMap;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Map;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.fasterxml.jackson.core.type.TypeReference;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Converter}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class ObjectToStringConverter implements AttributeConverter<Map<String, Object>, String> \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private static final ObjectMapper objectMapper = new ObjectMapper();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Override}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public String convertToDatabaseColumn(Map<String, Object> attribute) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         try \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             return attribute == null || attribute.isEmpty() ? "\{\}" :}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                     objectMapper.writeValueAsString(attribute);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \} catch (JsonProcessingException e) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             return "\{\}";}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 1: TransactionViewRepository.java =====}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.repository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.dto.TransactionStatsDTO;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.entity.TransactionEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.Query;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.repository.Repository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.repository.query.Param;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.List;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Map;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public interface TransactionViewRepository extends Repository<TransactionEntity, String> \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1057\'d1\u1090\'f2\u1072\'e0\u1090\'f2\u1080\'e8\u1089\'f1\u1090\'f2\u1080\'e8\u1082\'ea\u1072\'e0 \u1087\'ef\u1086\'ee \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1072\'e0\u1084\'ec}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = """}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         SELECT }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             status,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(*) as count,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM transactions), 2) as percentage}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         FROM transactions}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         GROUP BY status}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         ORDER BY count DESC}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         """, nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<Object[]> getStatusStatistics();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1057\'d1\u1090\'f2\u1072\'e0\u1090\'f2\u1080\'e8\u1089\'f1\u1090\'f2\u1080\'e8\u1082\'ea\u1072\'e0 \u1087\'ef\u1086\'ee \u1089\'f1\u1073\'e1\u1086\'ee\u1088\'f0\u1097\'f9\u1080\'e8\u1082\'ea\u1072\'e0\u1084\'ec}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = """}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         SELECT }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             collector_id,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(*) as total_transactions,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(CASE WHEN status = 'COMPLETED' THEN 1 END) as completed,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(CASE WHEN status = 'CANCELLED' THEN 1 END) as cancelled,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(CASE WHEN status IN ('PAUSED', 'WAITING_CLIENT', 'WAITING_OFFICE') THEN 1 END) as problem_transactions,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             AVG(EXTRACT(EPOCH FROM (completed_at - started_at))/60) as avg_completion_minutes}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         FROM transactions}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         WHERE collector_id IS NOT NULL}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         GROUP BY collector_id}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         ORDER BY total_transactions DESC}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         """, nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<Object[]> getCollectorStatistics();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1057\'d1\u1088\'f0\u1077\'e5\u1076\'e4\u1085\'ed\u1077\'e5\u1077\'e5 \u1074\'e2\u1088\'f0\u1077\'e5\u1084\'ec\u1103\'ff \u1074\'e2\u1099\'fb\u1087\'ef\u1086\'ee\u1083\'eb\u1085\'ed\u1077\'e5\u1085\'ed\u1080\'e8\u1103\'ff \u1087\'ef\u1086\'ee \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1072\'e0\u1084\'ec}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = """}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         SELECT }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             status,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             AVG(EXTRACT(EPOCH FROM (updated_at - created_at))/60) as avg_duration_minutes,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             MIN(EXTRACT(EPOCH FROM (updated_at - created_at))/60) as min_duration_minutes,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             MAX(EXTRACT(EPOCH FROM (updated_at - created_at))/60) as max_duration_minutes}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         FROM transactions}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         WHERE status IN ('COMPLETED', 'CANCELLED')}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         GROUP BY status}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         """, nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<Object[]> getAverageDurationByStatus();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1050\'ca\u1086\'ee\u1083\'eb\u1080\'e8\u1095\'f7\u1077\'e5\u1089\'f1\u1090\'f2\u1074\'e2\u1086\'ee \u1087\'ef\u1088\'f0\u1086\'ee\u1073\'e1\u1083\'eb\u1077\'e5\u1084\'ec\u1085\'ed\u1099\'fb\u1093\'f5 \u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1086\'ee\u1074\'e2 \u1087\'ef\u1086\'ee \u1076\'e4\u1085\'ed\u1103\'ff\u1084\'ec}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = """}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         SELECT }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             DATE(created_at) as date,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             SUM(jsonb_array_length(missing_items)) as missing_items_count,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(DISTINCT id) as transactions_with_problems}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         FROM transactions}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         WHERE jsonb_array_length(missing_items) > 0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         GROUP BY DATE(created_at)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         ORDER BY date DESC}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         LIMIT 30}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         """, nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<Object[]> getDailyProblemStatistics();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1058\'d2\u1086\'ee\u1087\'ef \u1087\'ef\u1088\'f0\u1086\'ee\u1073\'e1\u1083\'eb\u1077\'e5\u1084\'ec\u1085\'ed\u1099\'fb\u1093\'f5 \u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1086\'ee\u1074\'e2}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = """}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         WITH product_counts AS (}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             SELECT }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 key as product_id,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 SUM(value::int) as total_missing}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             FROM transactions,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             jsonb_each_text(missing_items)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             GROUP BY key}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         )}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         SELECT }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             product_id,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             total_missing}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         FROM product_counts}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         ORDER BY total_missing DESC}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         LIMIT 20}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         """, nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<Object[]> getTopProblematicProducts();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1069\'dd\u1092\'f4\u1092\'f4\u1077\'e5\u1082\'ea\u1090\'f2\u1080\'e8\u1074\'e2\u1085\'ed\u1086\'ee\u1089\'f1\u1090\'f2\u1100\'fc \u1089\'f1\u1073\'e1\u1086\'ee\u1088\'f0\u1097\'f9\u1080\'e8\u1082\'ea\u1086\'ee\u1074\'e2}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = """}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         SELECT }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             collector_id,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(*) as total_tasks,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(CASE WHEN status = 'COMPLETED' THEN 1 END) as completed_tasks,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             ROUND(COUNT(CASE WHEN status = 'COMPLETED' THEN 1 END) * 100.0 / COUNT(*), 2) as success_rate,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             AVG(EXTRACT(EPOCH FROM (completed_at - started_at))/60) as avg_task_time_minutes,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             SUM(jsonb_array_length(scanned_items)) as total_items_scanned}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         FROM transactions}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         WHERE collector_id IS NOT NULL}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         GROUP BY collector_id}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         HAVING COUNT(*) >= 5}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         ORDER BY success_rate DESC}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         """, nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<Object[]> getCollectorEfficiency();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1042\'c2\u1088\'f0\u1077\'e5\u1084\'ec\u1103\'ff \u1088\'f0\u1077\'e5\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1080\'e8 \u1082\'ea\u1083\'eb\u1080\'e8\u1077\'e5\u1085\'ed\u1090\'f2\u1086\'ee\u1074\'e2}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = """}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         SELECT }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             EXTRACT(HOUR FROM (client_responded_at - client_notified_at)) as response_hours,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(*) as response_count}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         FROM transactions}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         WHERE client_responded_at IS NOT NULL }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0           AND client_notified_at IS NOT NULL}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0           AND status IN ('COMPLETED', 'CANCELLED')}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         GROUP BY EXTRACT(HOUR FROM (client_responded_at - client_notified_at))}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         ORDER BY response_hours}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         """, nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<Object[]> getClientResponseTimeDistribution();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1088\'f0\u1086\'ee\u1094\'f6\u1077\'e5\u1085\'ed\u1090\'f2 \u1086\'ee\u1090\'f2\u1084\'ec\u1077\'e5\u1085\'ed\u1077\'e5\u1085\'ed\u1085\'ed\u1099\'fb\u1093\'f5 \u1079\'e7\u1072\'e0\u1082\'ea\u1072\'e0\u1079\'e7\u1086\'ee\u1074\'e2 \u1087\'ef\u1086\'ee \u1087\'ef\u1088\'f0\u1080\'e8\u1095\'f7\u1080\'e8\u1085\'ed\u1077\'e5}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = """}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         SELECT }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             CASE }\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 WHEN pause_reason LIKE '%not available%' THEN '\u1058\'d2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0 \u1086\'ee\u1090\'f2\u1089\'f1\u1091\'f3\u1090\'f2\u1089\'f1\u1090\'f2\u1074\'e2\u1091\'f3\u1077\'e5\u1090\'f2'}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 WHEN pause_reason LIKE '%damaged%' THEN '\u1058\'d2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0 \u1087\'ef\u1086\'ee\u1074\'e2\u1088\'f0\u1077\'e5\u1078\'e6\u1076\'e4\u1077\'e5\u1085\'ed'}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 WHEN pause_reason LIKE '%wrong%' THEN '\u1053\'cd\u1077\'e5\u1074\'e2\u1077\'e5\u1088\'f0\u1085\'ed\u1099\'fb\u1081\'e9 \u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0'}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 ELSE '\u1044\'c4\u1088\'f0\u1091\'f3\u1075\'e3\u1072\'e0\u1103\'ff \u1087\'ef\u1088\'f0\u1080\'e8\u1095\'f7\u1080\'e8\u1085\'ed\u1072\'e0'}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             END as reason_category,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             COUNT(*) as cancellation_count,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM transactions WHERE status = 'CANCELLED'), 2) as percentage}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         FROM transactions}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         WHERE status = 'CANCELLED' AND pause_reason IS NOT NULL}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         GROUP BY reason_category}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         ORDER BY cancellation_count DESC}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         """, nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<Object[]> getCancellationReasons();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 2: CompensationService.java =====}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.service;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.client.ExternalServiceClient;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.entity.CompensationLogEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.entity.TransactionEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.enums.TransactionStatus;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.repository.CompensationLogRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.repository.TransactionRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.slf4j.Logger;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.slf4j.LoggerFactory;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.beans.factory.annotation.Autowired;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.scheduling.annotation.Scheduled;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.stereotype.Service;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.transaction.annotation.Transactional;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.List;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Service}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class CompensationService \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private static final Logger log = LoggerFactory.getLogger(CompensationService.class);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private final CompensationLogRepository compensationLogRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private final TransactionRepository transactionRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private final ExternalServiceClient externalServiceClient;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Autowired}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public CompensationService(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             CompensationLogRepository compensationLogRepository,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             TransactionRepository transactionRepository,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             ExternalServiceClient externalServiceClient) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.compensationLogRepository = compensationLogRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.transactionRepository = transactionRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         this.externalServiceClient = externalServiceClient;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void initiateCompensation(String transactionId, String reason, String details) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         TransactionEntity transaction = transactionRepository.findById(transactionId)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 .orElseThrow(() -> new RuntimeException("Transaction not found"));}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         CompensationLogEntity compensation = new CompensationLogEntity();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensation.setTransactionId(transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensation.setCompensationType("FULL");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensation.setReason(reason);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensation.setStatus("PENDING");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensation.setCompensationData("\{\\"details\\": \\"" + details + "\\"\}");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensationLogRepository.save(compensation);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         transaction.setStatus(TransactionStatus.COMPENSATING);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         transactionRepository.save(transaction);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Scheduled(fixedDelay = 60000)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void processPendingCompensations() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         List<CompensationLogEntity> pendingCompensations =}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 compensationLogRepository.findByStatus("PENDING");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         for (CompensationLogEntity compensation : pendingCompensations) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             try \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 executeCompensation(compensation);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             \} catch (Exception e) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 log.error("Compensation failed for \{\}: \{\}",}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                         compensation.getId(), e.getMessage());}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 compensation.setStatus("FAILED");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 compensation.setErrorMessage(e.getMessage());}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 compensationLogRepository.save(compensation);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private void executeCompensation(CompensationLogEntity compensation) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensation.setStatus("IN_PROGRESS");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensation.setStartedAt(LocalDateTime.now());}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensationLogRepository.save(compensation);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         externalServiceClient.cancelReservations(compensation.getTransactionId());}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         externalServiceClient.notifyCollectorAboutCancellation(compensation.getTransactionId());}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         externalServiceClient.processRefund(compensation.getTransactionId());}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensation.setStatus("COMPLETED");}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensation.setCompletedAt(LocalDateTime.now());}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         compensationLogRepository.save(compensation);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         TransactionEntity transaction = transactionRepository}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                 .findById(compensation.getTransactionId()).orElse(null);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (transaction != null) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             transaction.setStatus(TransactionStatus.CANCELLED);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             transactionRepository.save(transaction);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public List<CompensationLogEntity> getCompensationHistory(String transactionId) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return compensationLogRepository.findByTransactionId(transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 3: SagaStepRepository.java =====}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.repository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.entity.SagaStepEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.enums.SagaStepType;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.JpaRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.Modifying;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.Query;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.repository.query.Param;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.stereotype.Repository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.transaction.annotation.Transactional;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.List;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Optional;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Repository}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public interface SagaStepRepository extends JpaRepository<SagaStepEntity, Long> \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1086\'ee ID \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findByTransactionId(String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findByTransactionIdOrderByStepOrderAsc(String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1086\'ee \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1091\'f3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findByTransactionIdAndStatus(String transactionId, String status);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findByStatus(String status);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1086\'ee \u1090\'f2\u1080\'e8\u1087\'ef\u1091\'f3 \u1096\'f8\u1072\'e0\u1075\'e3\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Optional<SagaStepEntity> findByTransactionIdAndStepType(String transactionId, SagaStepType stepType);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findByStepType(SagaStepType stepType);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1096\'f8\u1072\'e0\u1075\'e3\u1086\'ee\u1074\'e2 \u1076\'e4\u1083\'eb\u1103\'ff \u1087\'ef\u1086\'ee\u1074\'e2\u1090\'f2\u1086\'ee\u1088\'f0\u1085\'ed\u1086\'ee\u1081\'e9 \u1087\'ef\u1086\'ee\u1087\'ef\u1099\'fb\u1090\'f2\u1082\'ea\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT s FROM SagaStepEntity s WHERE s.status = 'FAILED' AND s.retryCount < s.maxRetries AND (s.nextRetryTime IS NULL OR s.nextRetryTime <= CURRENT_TIMESTAMP)")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findStepsForRetry();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1085\'ed\u1077\'e5\u1079\'e7\u1072\'e0\u1074\'e2\u1077\'e5\u1088\'f0\u1096\'f8\u1077\'e5\u1085\'ed\u1085\'ed\u1099\'fb\u1093\'f5 \u1096\'f8\u1072\'e0\u1075\'e3\u1086\'ee\u1074\'e2}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT s FROM SagaStepEntity s WHERE s.transactionId = :transactionId AND s.status IN ('PENDING', 'IN_PROGRESS', 'FAILED')")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findIncompleteStepsByTransactionId(@Param("transactionId") String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1080\'e8\u1088\'f0\u1091\'f3\u1077\'e5\u1084\'ec\u1099\'fb\u1093\'f5 \u1096\'f8\u1072\'e0\u1075\'e3\u1086\'ee\u1074\'e2}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT s FROM SagaStepEntity s WHERE s.transactionId = :transactionId AND s.isCompensatable = true AND s.status = 'COMPLETED'")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findCompensatableStepsByTransactionId(@Param("transactionId") String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1076\'e4\u1089\'f1\u1095\'f7\u1077\'e5\u1090\'f2 \u1096\'f8\u1072\'e0\u1075\'e3\u1086\'ee\u1074\'e2}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     long countByTransactionId(String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     long countByTransactionIdAndStatus(String transactionId, String status);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1054\'ce\u1073\'e1\u1085\'ed\u1086\'ee\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1072\'e0 \u1096\'f8\u1072\'e0\u1075\'e3\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("UPDATE SagaStepEntity s SET s.status = :status, s.completedAt = :completedAt, s.durationMs = :durationMs WHERE s.id = :stepId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int updateStepStatus(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("stepId") Long stepId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("status") String status,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("completedAt") LocalDateTime completedAt,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("durationMs") Long durationMs);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1054\'ce\u1073\'e1\u1085\'ed\u1086\'ee\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1072\'e0 \u1089\'f1 \u1086\'ee\u1096\'f8\u1080\'e8\u1073\'e1\u1082\'ea\u1086\'ee\u1081\'e9}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("UPDATE SagaStepEntity s SET s.status = 'FAILED', s.errorMessage = :errorMessage, s.retryCount = s.retryCount + 1, s.nextRetryTime = :nextRetryTime WHERE s.id = :stepId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int markStepAsFailed(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("stepId") Long stepId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("errorMessage") String errorMessage,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("nextRetryTime") LocalDateTime nextRetryTime);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1088\'f0\u1086\'ee\u1087\'ef\u1091\'f3\u1089\'f1\u1082\'ea \u1096\'f8\u1072\'e0\u1075\'e3\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("UPDATE SagaStepEntity s SET s.status = 'SKIPPED', s.completedAt = CURRENT_TIMESTAMP WHERE s.id = :stepId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int skipStep(@Param("stepId") Long stepId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1054\'ce\u1090\'f2\u1084\'ec\u1077\'e5\u1090\'f2\u1082\'ea\u1072\'e0 \u1082\'ea\u1072\'e0\u1082\'ea \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1080\'e8\u1088\'f0\u1086\'ee\u1074\'e2\u1072\'e0\u1085\'ed\u1085\'ed\u1086\'ee\u1075\'e3\u1086\'ee}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("UPDATE SagaStepEntity s SET s.status = 'COMPENSATED', s.compensatedAt = CURRENT_TIMESTAMP WHERE s.id = :stepId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int markAsCompensated(@Param("stepId") Long stepId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1096\'f8\u1072\'e0\u1075\'e3\u1086\'ee\u1074\'e2 \u1087\'ef\u1086\'ee \u1079\'e7\u1072\'e0\u1074\'e2\u1080\'e8\u1089\'f1\u1080\'e8\u1084\'ec\u1086\'ee\u1089\'f1\u1090\'f2\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT s FROM SagaStepEntity s WHERE s.dependsOnStepId = :stepId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findByDependsOnStepId(@Param("stepId") Long stepId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1083\'eb\u1091\'f3\u1095\'f7\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1089\'f1\u1083\'eb\u1077\'e5\u1076\'e4\u1091\'f3\u1102\'fe\u1097\'f9\u1077\'e5\u1075\'e3\u1086\'ee \u1096\'f8\u1072\'e0\u1075\'e3\u1072\'e0 \u1087\'ef\u1086\'ee \u1087\'ef\u1086\'ee\u1088\'f0\u1103\'ff\u1076\'e4\u1082\'ea\u1091\'f3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT s FROM SagaStepEntity s WHERE s.transactionId = :transactionId AND s.stepOrder > :currentOrder ORDER BY s.stepOrder ASC LIMIT 1")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Optional<SagaStepEntity> findNextStep(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("transactionId") String transactionId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("currentOrder") Integer currentOrder);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1088\'f0\u1086\'ee\u1074\'e2\u1077\'e5\u1088\'f0\u1082\'ea\u1072\'e0 \u1075\'e3\u1086\'ee\u1090\'f2\u1086\'ee\u1074\'e2\u1085\'ed\u1086\'ee\u1089\'f1\u1090\'f2\u1080\'e8 \u1096\'f8\u1072\'e0\u1075\'e3\u1072\'e0 \u1082\'ea \u1074\'e2\u1099\'fb\u1087\'ef\u1086\'ee\u1083\'eb\u1085\'ed\u1077\'e5\u1085\'ed\u1080\'e8\u1102\'fe}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT CASE WHEN COUNT(s) = 0 THEN true ELSE false END FROM SagaStepEntity s WHERE s.transactionId = :transactionId AND s.dependsOnStepId = :stepId AND s.status != 'COMPLETED'")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     boolean isStepReadyToExecute(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("transactionId") String transactionId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("stepId") Long stepId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1096\'f8\u1072\'e0\u1075\'e3\u1086\'ee\u1074\'e2 \u1076\'e4\u1083\'eb\u1103\'ff \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1080\'e8 (\u1086\'ee\u1073\'e1\u1088\'f0\u1072\'e0\u1090\'f2\u1085\'ed\u1099\'fb\u1081\'e9 \u1087\'ef\u1086\'ee\u1088\'f0\u1103\'ff\u1076\'e4\u1086\'ee\u1082\'ea)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT s FROM SagaStepEntity s WHERE s.transactionId = :transactionId AND s.isCompensatable = true AND s.status = 'COMPLETED' ORDER BY s.stepOrder DESC")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<SagaStepEntity> findStepsForCompensation(@Param("transactionId") String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 4: CompensationLogRepository.java =====}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.repository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.entity.CompensationLogEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.JpaRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.Modifying;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.Query;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.repository.query.Param;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.stereotype.Repository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.transaction.annotation.Transactional;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.List;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Optional;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Repository}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public interface CompensationLogRepository extends JpaRepository<CompensationLogEntity, Long> \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1086\'ee ID \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<CompensationLogEntity> findByTransactionId(String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<CompensationLogEntity> findByTransactionIdOrderByCreatedAtDesc(String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1086\'ee \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1091\'f3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<CompensationLogEntity> findByStatus(String status);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<CompensationLogEntity> findByTransactionIdAndStatus(String transactionId, String status);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1086\'ee \u1090\'f2\u1080\'e8\u1087\'ef\u1091\'f3 \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<CompensationLogEntity> findByCompensationType(String compensationType);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1086\'ee \u1096\'f8\u1072\'e0\u1075\'e3\u1091\'f3 \u1089\'f1\u1072\'e0\u1075\'e3\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Optional<CompensationLogEntity> findBySagaStepId(Long sagaStepId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1085\'ed\u1077\'e5\u1091\'f3\u1076\'e4\u1072\'e0\u1095\'f7\u1085\'ed\u1099\'fb\u1093\'f5 \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1081\'e9 \u1076\'e4\u1083\'eb\u1103\'ff \u1087\'ef\u1086\'ee\u1074\'e2\u1090\'f2\u1086\'ee\u1088\'f0\u1085\'ed\u1086\'ee\u1081\'e9 \u1087\'ef\u1086\'ee\u1087\'ef\u1099\'fb\u1090\'f2\u1082\'ea\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT c FROM CompensationLogEntity c WHERE c.status = 'FAILED' AND c.retryCount < 3")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<CompensationLogEntity> findFailedCompensationsForRetry();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1072\'e0\u1082\'ea\u1090\'f2\u1080\'e8\u1074\'e2\u1085\'ed\u1099\'fb\u1093\'f5 \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1081\'e9}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT c FROM CompensationLogEntity c WHERE c.status IN ('PENDING', 'IN_PROGRESS')")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<CompensationLogEntity> findActiveCompensations();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1057\'d1\u1090\'f2\u1072\'e0\u1090\'f2\u1080\'e8\u1089\'f1\u1090\'f2\u1080\'e8\u1082\'ea\u1072\'e0 \u1087\'ef\u1086\'ee \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1103\'ff\u1084\'ec}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT COUNT(c) FROM CompensationLogEntity c WHERE c.transactionId = :transactionId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     long countByTransactionId(@Param("transactionId") String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT COUNT(c) FROM CompensationLogEntity c WHERE c.transactionId = :transactionId AND c.status = 'COMPLETED'")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     long countCompletedByTransactionId(@Param("transactionId") String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT COUNT(c) FROM CompensationLogEntity c WHERE c.transactionId = :transactionId AND c.status = 'FAILED'")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     long countFailedByTransactionId(@Param("transactionId") String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1054\'ce\u1073\'e1\u1085\'ed\u1086\'ee\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1072\'e0 \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("UPDATE CompensationLogEntity c SET c.status = :status, c.completedAt = :completedAt, c.durationMs = :durationMs WHERE c.id = :logId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int updateCompensationStatus(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("logId") Long logId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("status") String status,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("completedAt") LocalDateTime completedAt,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("durationMs") Long durationMs);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1054\'ce\u1073\'e1\u1085\'ed\u1086\'ee\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1072\'e0 \u1089\'f1 \u1086\'ee\u1096\'f8\u1080\'e8\u1073\'e1\u1082\'ea\u1086\'ee\u1081\'e9}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("UPDATE CompensationLogEntity c SET c.status = 'FAILED', c.errorMessage = :errorMessage, c.retryCount = c.retryCount + 1 WHERE c.id = :logId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int markCompensationAsFailed(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("logId") Long logId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("errorMessage") String errorMessage);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1081\'e9 \u1087\'ef\u1086\'ee \u1074\'e2\u1088\'f0\u1077\'e5\u1084\'ec\u1077\'e5\u1085\'ed\u1085\'ed\u1086\'ee\u1084\'ec\u1091\'f3 \u1076\'e4\u1080\'e8\u1072\'e0\u1087\'ef\u1072\'e0\u1079\'e7\u1086\'ee\u1085\'ed\u1091\'f3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT c FROM CompensationLogEntity c WHERE c.createdAt BETWEEN :startDate AND :endDate")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<CompensationLogEntity> findByCreatedAtBetween(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("startDate") LocalDateTime startDate,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("endDate") LocalDateTime endDate);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1083\'eb\u1091\'f3\u1095\'f7\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1087\'ef\u1086\'ee\u1089\'f1\u1083\'eb\u1077\'e5\u1076\'e4\u1085\'ed\u1077\'e5\u1081\'e9 \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1080\'e8 \u1076\'e4\u1083\'eb\u1103\'ff \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT c FROM CompensationLogEntity c WHERE c.transactionId = :transactionId ORDER BY c.createdAt DESC LIMIT 1")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Optional<CompensationLogEntity> findLatestByTransactionId(@Param("transactionId") String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1088\'f0\u1086\'ee\u1074\'e2\u1077\'e5\u1088\'f0\u1082\'ea\u1072\'e0 \u1089\'f1\u1091\'f3\u1097\'f9\u1077\'e5\u1089\'f1\u1090\'f2\u1074\'e2\u1086\'ee\u1074\'e2\u1072\'e0\u1085\'ed\u1080\'e8\u1103\'ff \u1072\'e0\u1082\'ea\u1090\'f2\u1080\'e8\u1074\'e2\u1085\'ed\u1086\'ee\u1081\'e9 \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT CASE WHEN COUNT(c) > 0 THEN true ELSE false END FROM CompensationLogEntity c WHERE c.transactionId = :transactionId AND c.status IN ('PENDING', 'IN_PROGRESS')")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     boolean existsActiveCompensation(@Param("transactionId") String transactionId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1081\'e9 \u1076\'e4\u1083\'eb\u1103\'ff \u1086\'ee\u1087\'ef\u1088\'f0\u1077\'e5\u1076\'e4\u1077\'e5\u1083\'eb\u1077\'e5\u1085\'ed\u1085\'ed\u1086\'ee\u1075\'e3\u1086\'ee \u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = "SELECT c FROM CompensationLogEntity c WHERE c.compensatedItems LIKE %:productId%")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<CompensationLogEntity> findByProductId(@Param("productId") String productId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1043\'c3\u1088\'f0\u1091\'f3\u1087\'ef\u1087\'ef\u1080\'e8\u1088\'f0\u1086\'ee\u1074\'e2\u1082\'ea\u1072\'e0 \u1087\'ef\u1086\'ee \u1090\'f2\u1080\'e8\u1087\'ef\u1091\'f3 \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT c.compensationType, COUNT(c) FROM CompensationLogEntity c GROUP BY c.compensationType")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<Object[]> countByCompensationType();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1057\'d1\u1088\'f0\u1077\'e5\u1076\'e4\u1085\'ed\u1077\'e5\u1077\'e5 \u1074\'e2\u1088\'f0\u1077\'e5\u1084\'ec\u1103\'ff \u1082\'ea\u1086\'ee\u1084\'ec\u1087\'ef\u1077\'e5\u1085\'ed\u1089\'f1\u1072\'e0\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT AVG(c.durationMs) FROM CompensationLogEntity c WHERE c.status = 'COMPLETED' AND c.durationMs IS NOT NULL")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Optional<Double> findAverageCompensationDuration();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 5: TransactionRepository.java =====}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.repository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.entity.TransactionEntity;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import com.example.TransactionSaga.model.enums.TransactionStatus;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.JpaRepository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.Modifying;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.jpa.repository.Query;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.data.repository.query.Param;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.stereotype.Repository;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.transaction.annotation.Transactional;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.List;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.util.Optional;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @Repository}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public interface TransactionRepository extends JpaRepository<TransactionEntity, String> \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1054\'ce\u1089\'f1\u1085\'ed\u1086\'ee\u1074\'e2\u1085\'ed\u1099\'fb\u1077\'e5 \u1087\'ef\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Optional<TransactionEntity> findByOrderId(String orderId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findByCollectorId(String collectorId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findByClientId(String clientId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findByStatus(TransactionStatus status);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1086\'ee \u1085\'ed\u1077\'e5\u1089\'f1\u1082\'ea\u1086\'ee\u1083\'eb\u1100\'fc\u1082\'ea\u1080\'e8\u1084\'ec \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1072\'e0\u1084\'ec}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT t FROM TransactionEntity t WHERE t.status IN :statuses ORDER BY t.createdAt DESC")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findByStatusIn(@Param("statuses") List<TransactionStatus> statuses);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1072\'e0\u1082\'ea\u1090\'f2\u1080\'e8\u1074\'e2\u1085\'ed\u1099\'fb\u1093\'f5 \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1081\'e9 \u1089\'f1\u1073\'e1\u1086\'ee\u1088\'f0\u1097\'f9\u1080\'e8\u1082\'ea\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT t FROM TransactionEntity t WHERE t.collectorId = :collectorId AND t.status IN :activeStatuses")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findActiveByCollectorId(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("collectorId") String collectorId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("activeStatuses") List<TransactionStatus> activeStatuses);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1081\'e9 \u1089\'f1 \u1087\'ef\u1088\'f0\u1086\'ee\u1073\'e1\u1083\'eb\u1077\'e5\u1084\'ec\u1072\'e0\u1084\'ec\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT t FROM TransactionEntity t WHERE t.status = 'WAITING_CLIENT' OR t.status = 'WAITING_OFFICE'")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findProblemTransactions();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1088\'f0\u1086\'ee\u1089\'f1\u1088\'f0\u1086\'ee\u1095\'f7\u1077\'e5\u1085\'ed\u1085\'ed\u1099\'fb\u1093\'f5 \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1081\'e9}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT t FROM TransactionEntity t WHERE t.status = :status AND t.clientNotifiedAt < :threshold")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findTimeoutTransactions(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("status") TransactionStatus status,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("threshold") LocalDateTime threshold);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1057\'d1\u1090\'f2\u1072\'e0\u1090\'f2\u1080\'e8\u1089\'f1\u1090\'f2\u1080\'e8\u1082\'ea\u1072\'e0 \u1087\'ef\u1086\'ee \u1082\'ea\u1086\'ee\u1083\'eb\u1083\'eb\u1077\'e5\u1082\'ea\u1090\'f2\u1086\'ee\u1088\'f0\u1091\'f3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT COUNT(t) FROM TransactionEntity t WHERE t.collectorId = :collectorId AND t.status = 'ACTIVE'")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     long countActiveTransactionsByCollector(@Param("collectorId") String collectorId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT COUNT(t) FROM TransactionEntity t WHERE t.collectorId = :collectorId AND t.status IN ('COMPLETED', 'CANCELLED')")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     long countCompletedTransactionsByCollector(@Param("collectorId") String collectorId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1048\'c8\u1089\'f1\u1090\'f2\u1086\'ee\u1088\'f0\u1080\'e8\u1103\'ff \u1079\'e7\u1072\'e0\u1082\'ea\u1072\'e0\u1079\'e7\u1086\'ee\u1074\'e2}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT t FROM TransactionEntity t WHERE t.orderId = :orderId ORDER BY t.createdAt DESC")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findHistoryByOrderId(@Param("orderId") String orderId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1081\'e9 \u1089\'f1 \u1086\'ee\u1090\'f2\u1089\'f1\u1091\'f3\u1090\'f2\u1089\'f1\u1090\'f2\u1074\'e2\u1091\'f3\u1102\'fe\u1097\'f9\u1080\'e8\u1084\'ec\u1080\'e8 \u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1072\'e0\u1084\'ec\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT t FROM TransactionEntity t WHERE SIZE(t.missingItems) > 0")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findTransactionsWithMissingItems();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1054\'ce\u1073\'e1\u1085\'ed\u1086\'ee\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1072\'e0 \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("UPDATE TransactionEntity t SET t.status = :newStatus, t.updatedAt = CURRENT_TIMESTAMP WHERE t.id = :transactionId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int updateTransactionStatus(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("transactionId") String transactionId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("newStatus") TransactionStatus newStatus);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1054\'ce\u1073\'e1\u1085\'ed\u1086\'ee\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1089\'f1\u1090\'f2\u1072\'e0\u1090\'f2\u1091\'f3\u1089\'f1\u1072\'e0 \u1089\'f1 \u1087\'ef\u1088\'f0\u1080\'e8\u1095\'f7\u1080\'e8\u1085\'ed\u1086\'ee\u1081\'e9}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("UPDATE TransactionEntity t SET t.status = :newStatus, t.pauseReason = :reason, t.updatedAt = CURRENT_TIMESTAMP WHERE t.id = :transactionId")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int pauseTransaction(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("transactionId") String transactionId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("newStatus") TransactionStatus newStatus,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("reason") String reason);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1044\'c4\u1086\'ee\u1073\'e1\u1072\'e0\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1086\'ee\u1090\'f2\u1089\'f1\u1082\'ea\u1072\'e0\u1085\'ed\u1080\'e8\u1088\'f0\u1086\'ee\u1074\'e2\u1072\'e0\u1085\'ed\u1085\'ed\u1086\'ee\u1075\'e3\u1086\'ee \u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = "UPDATE transactions SET scanned_items = scanned_items || jsonb_build_object(:productId, :quantity), updated_at = CURRENT_TIMESTAMP WHERE id = :transactionId", nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int addScannedItem(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("transactionId") String transactionId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("productId") String productId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("quantity") Integer quantity);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1044\'c4\u1086\'ee\u1073\'e1\u1072\'e0\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1086\'ee\u1090\'f2\u1089\'f1\u1091\'f3\u1090\'f2\u1089\'f1\u1090\'f2\u1074\'e2\u1091\'f3\u1102\'fe\u1097\'f9\u1077\'e5\u1075\'e3\u1086\'ee \u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = "UPDATE transactions SET missing_items = missing_items || jsonb_build_object(:productId, :quantity), updated_at = CURRENT_TIMESTAMP WHERE id = :transactionId", nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int addMissingItem(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("transactionId") String transactionId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("productId") String productId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("quantity") Integer quantity);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1059\'d3\u1076\'e4\u1072\'e0\u1083\'eb\u1077\'e5\u1085\'ed\u1080\'e8\u1077\'e5 \u1086\'ee\u1090\'f2\u1089\'f1\u1091\'f3\u1090\'f2\u1089\'f1\u1090\'f2\u1074\'e2\u1091\'f3\u1102\'fe\u1097\'f9\u1077\'e5\u1075\'e3\u1086\'ee \u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Modifying}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Transactional}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query(value = "UPDATE transactions SET missing_items = missing_items - :productId, updated_at = CURRENT_TIMESTAMP WHERE id = :transactionId", nativeQuery = true)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     int removeMissingItem(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("transactionId") String transactionId,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("productId") String productId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1081\'e9 \u1087\'ef\u1086\'ee \u1074\'e2\u1088\'f0\u1077\'e5\u1084\'ec\u1077\'e5\u1085\'ed\u1085\'ed\u1086\'ee\u1084\'ec\u1091\'f3 \u1076\'e4\u1080\'e8\u1072\'e0\u1087\'ef\u1072\'e0\u1079\'e7\u1086\'ee\u1085\'ed\u1091\'f3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT t FROM TransactionEntity t WHERE t.createdAt BETWEEN :startDate AND :endDate")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     List<TransactionEntity> findByCreatedAtBetween(}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("startDate") LocalDateTime startDate,}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             @Param("endDate") LocalDateTime endDate);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1088\'f0\u1086\'ee\u1074\'e2\u1077\'e5\u1088\'f0\u1082\'ea\u1072\'e0 \u1089\'f1\u1091\'f3\u1097\'f9\u1077\'e5\u1089\'f1\u1090\'f2\u1074\'e2\u1086\'ee\u1074\'e2\u1072\'e0\u1085\'ed\u1080\'e8\u1103\'ff \u1072\'e0\u1082\'ea\u1090\'f2\u1080\'e8\u1074\'e2\u1085\'ed\u1086\'ee\u1081\'e9 \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1080\'e8 \u1076\'e4\u1083\'eb\u1103\'ff \u1079\'e7\u1072\'e0\u1082\'ea\u1072\'e0\u1079\'e7\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT CASE WHEN COUNT(t) > 0 THEN true ELSE false END FROM TransactionEntity t WHERE t.orderId = :orderId AND t.status IN ('CREATED', 'ACTIVE', 'PAUSED', 'WAITING_CLIENT', 'WAITING_OFFICE')")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     boolean existsActiveTransactionForOrder(@Param("orderId") String orderId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1055\'cf\u1086\'ee\u1080\'e8\u1089\'f1\u1082\'ea \u1087\'ef\u1086\'ee\u1089\'f1\u1083\'eb\u1077\'e5\u1076\'e4\u1085\'ed\u1077\'e5\u1081\'e9 \u1090\'f2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1080\'e8 \u1076\'e4\u1083\'eb\u1103\'ff \u1079\'e7\u1072\'e0\u1082\'ea\u1072\'e0\u1079\'e7\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Query("SELECT t FROM TransactionEntity t WHERE t.orderId = :orderId ORDER BY t.createdAt DESC LIMIT 1")}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     Optional<TransactionEntity> findLatestByOrderId(@Param("orderId") String orderId);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 6: TransactionSagaApplication.java =====}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.scheduling.annotation.EnableScheduling;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.boot.SpringApplication;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import org.springframework.boot.autoconfigure.SpringBootApplication;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 @SpringBootApplication}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class TransactionSagaApplication \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \tab public static void main(String[] args) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \tab \tab SpringApplication.run(TransactionSagaApplication.class, args);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \tab \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 7: TransactionStatsDTO.java =====}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.dto;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 import java.time.LocalDateTime;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public class TransactionStatsDTO \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime periodStart;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private LocalDateTime periodEnd;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private long totalTransactions;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private long completedTransactions;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private long cancelledTransactions;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private long problemTransactions;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private long pendingTransactions;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private double avgCompletionTimeMinutes;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private double successRate;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private long totalItemsScanned;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     private long totalItemsMissing;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1043\'c3\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb \u1080\'e8 \u1089\'f1\u1077\'e5\u1090\'f2\u1090\'f2\u1077\'e5\u1088\'f0\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getPeriodStart() \{ return periodStart; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setPeriodStart(LocalDateTime periodStart) \{ this.periodStart = periodStart; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public LocalDateTime getPeriodEnd() \{ return periodEnd; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setPeriodEnd(LocalDateTime periodEnd) \{ this.periodEnd = periodEnd; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public long getTotalTransactions() \{ return totalTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setTotalTransactions(long totalTransactions) \{ this.totalTransactions = totalTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public long getCompletedTransactions() \{ return completedTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCompletedTransactions(long completedTransactions) \{ this.completedTransactions = completedTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public long getCancelledTransactions() \{ return cancelledTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setCancelledTransactions(long cancelledTransactions) \{ this.cancelledTransactions = cancelledTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public long getProblemTransactions() \{ return problemTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setProblemTransactions(long problemTransactions) \{ this.problemTransactions = problemTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public long getPendingTransactions() \{ return pendingTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setPendingTransactions(long pendingTransactions) \{ this.pendingTransactions = pendingTransactions; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public double getAvgCompletionTimeMinutes() \{ return avgCompletionTimeMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setAvgCompletionTimeMinutes(double avgCompletionTimeMinutes) \{ this.avgCompletionTimeMinutes = avgCompletionTimeMinutes; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public double getSuccessRate() \{ return successRate; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setSuccessRate(double successRate) \{ this.successRate = successRate; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public long getTotalItemsScanned() \{ return totalItemsScanned; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setTotalItemsScanned(long totalItemsScanned) \{ this.totalItemsScanned = totalItemsScanned; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public long getTotalItemsMissing() \{ return totalItemsMissing; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public void setTotalItemsMissing(long totalItemsMissing) \{ this.totalItemsMissing = totalItemsMissing; \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     // \u1042\'c2\u1089\'f1\u1087\'ef\u1086\'ee\u1084\'ec\u1086\'ee\u1075\'e3\u1072\'e0\u1090\'f2\u1077\'e5\u1083\'eb\u1100\'fc\u1085\'ed\u1099\'fb\u1077\'e5 \u1084\'ec\u1077\'e5\u1090\'f2\u1086\'ee\u1076\'e4\u1099\'fb}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public double getCancellationRate() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return totalTransactions > 0 ? (cancelledTransactions * 100.0) / totalTransactions : 0;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public double getProblemRate() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return totalTransactions > 0 ? (problemTransactions * 100.0) / totalTransactions : 0;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public long getSuccessfulTransactions() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return completedTransactions;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public double getEfficiencyScore() \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (totalTransactions == 0) return 0;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         double score = successRate * 0.6;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         if (avgCompletionTimeMinutes > 0) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             score += (60.0 / Math.max(avgCompletionTimeMinutes, 1)) * 0.4;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         return Math.min(score, 100);}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 8: application.properties =====}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # SERVER CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 server.port=8090}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 server.servlet.context-path=/transaction-saga}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 server.error.include-stacktrace=never}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 server.error.include-message=always}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 server.compression.enabled=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 server.compression.min-response-size=1024}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # SPRING APPLICATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.application.name=transaction-saga}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.profiles.active=dev}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # DATABASE CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.datasource.url=jdbc:postgresql://localhost:5432/kefir_db}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.datasource.username=postgres}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.datasource.password=Ghbdtnbr123!}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.datasource.driver-class-name=org.postgresql.Driver}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.datasource.hikari.connection-timeout=30000}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.datasource.hikari.maximum-pool-size=10}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.datasource.hikari.minimum-idle=5}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.datasource.hikari.idle-timeout=600000}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.datasource.hikari.max-lifetime=1800000}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # JPA / HIBERNATE CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.hibernate.ddl-auto=update}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.show-sql=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.properties.hibernate.format_sql=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.properties.hibernate.jdbc.batch_size=20}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.properties.hibernate.order_inserts=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.properties.hibernate.order_updates=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.properties.hibernate.query.fail_on_pagination_over_collection_fetch=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.properties.hibernate.default_schema=public}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.properties.hibernate.id.new_generator_mappings=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # SPRING CLOUD OPENFEIGN CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 feign.client.config.default.connect-timeout=5000}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 feign.client.config.default.read-timeout=10000}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 feign.client.config.default.logger-level=basic}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 feign.compression.request.enabled=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 feign.compression.response.enabled=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 feign.compression.request.mime-types=text/xml,application/xml,application/json}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 feign.compression.request.min-request-size=2048}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # EXTERNAL SERVICES URLS}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 services.office.url=http://localhost:8085}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 services.collector.url=http://localhost:8086}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 services.product.url=http://localhost:8082}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 services.delivery.url=http://localhost:8088}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 services.cart.url=http://localhost:8083}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 services.client.url=http://localhost:8081}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # SAGA ORCHESTRATOR CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 saga.retry.max-attempts=3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 saga.retry.delay-minutes=5}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 saga.retry.max-delay-minutes=60}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 saga.timeout.default-minutes=1440}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 saga.timeout.client-response-minutes=120}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 saga.cleanup.completed-transactions-hours=24}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 saga.cleanup.failed-transactions-hours=72}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 saga.batch.size=50}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 saga.batch.delay-ms=1000}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # SCHEDULING CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 scheduling.enabled=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 scheduling.pool.size=5}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 scheduling.thread-name-prefix=saga-scheduler-}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # CACHE CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.cache.type=caffeine}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=10m}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # LOGGING CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.level.com.example.TransactionSaga=DEBUG}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.level.org.springframework.cloud.openfeign=INFO}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.level.org.springframework.web=INFO}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.level.org.hibernate.SQL=DEBUG}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.level.org.springframework.scheduling=INFO}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.level.org.springframework.transaction=DEBUG}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.file.name=logs/transaction-saga.log}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.file.max-size=10MB}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.file.max-history=30}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.pattern.console=%d\{yyyy-MM-dd HH:mm:ss\} [%thread] %-5level %logger\{36\} - %msg%n}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 logging.pattern.file=%d\{yyyy-MM-dd HH:mm:ss\} [%thread] %-5level %logger\{36\} - %msg%n}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ACTUATOR / METRICS}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 management.endpoints.web.exposure.include=health,info,metrics,prometheus}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 management.endpoint.health.show-details=always}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 management.metrics.export.prometheus.enabled=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 management.metrics.distribution.percentiles-histogram.http.server.requests=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # SECURITY (???? ?????)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # spring.security.enabled=false}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # spring.security.user.name=admin}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # spring.security.user.password=admin}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # spring.security.user.roles=ADMIN}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # RESILIENCE4J CIRCUIT BREAKER (???????????)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # resilience4j.circuitbreaker.configs.default.slidingWindowSize=10}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # resilience4j.circuitbreaker.configs.default.failureRateThreshold=50}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # resilience4j.circuitbreaker.configs.default.waitDurationInOpenState=5000}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # resilience4j.circuitbreaker.configs.default.permittedNumberOfCallsInHalfOpenState=3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # resilience4j.circuitbreaker.configs.default.automaticTransitionFromOpenToHalfOpenEnabled=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # JACKSON / JSON CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jackson.date-format=yyyy-MM-dd'T'HH:mm:ss.SSS'Z'}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jackson.time-zone=UTC}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jackson.default-property-inclusion=NON_NULL}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jackson.serialization.WRITE_DATES_AS_TIMESTAMPS=false}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jackson.serialization.FAIL_ON_EMPTY_BEANS=false}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jackson.deserialization.FAIL_ON_UNKNOWN_PROPERTIES=false}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # HTTP CLIENT CONFIGURATION}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.web.client.connection-timeout=5000}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.web.client.read-timeout=10000}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 rest.client.max-total-connections=20}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 rest.client.default-max-per-route=10}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # TRANSACTION MANAGEMENT}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.transaction.default-timeout=30}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.jpa.open-in-view=false}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # DEVTOOLS (?????? ??? ??????????)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 # ============================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.devtools.restart.enabled=true}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 spring.devtools.livereload.enabled=false}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ===== \u1060\'d4\u1040\'c0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     @Override}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     public Map<String, Object> convertToEntityAttribute(String dbData) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         try \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             return dbData == null || dbData.isEmpty() || "\{\}".equals(dbData) ?}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                     new HashMap<>() :}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0                     objectMapper.readValue(dbData, new TypeReference<Map<String, Object>>() \{\});}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \} catch (IOException e) \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0             return new HashMap<>();}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0         \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\loch\af2\dbch\af3\hich\f2\fs24\cf0 \u1060\'d4\u1072\'e0\u1081\'e9\u1083\'eb: TransactionStatus.java}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 ========================================}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 package com.example.TransactionSaga.model.enums;}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 public enum TransactionStatus \{}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     CREATED,        // \u1058\'d2\u1088\'f0\u1072\'e0\u1085\'ed\u1079\'e7\u1072\'e0\u1082\'ea\u1094\'f6\u1080\'e8\u1103\'ff \u1089\'f1\u1086\'ee\u1079\'e7\u1076\'e4\u1072\'e0\u1085\'ed\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     ACTIVE,         // \u1042\'c2 \u1087\'ef\u1088\'f0\u1086\'ee\u1094\'f6\u1077\'e5\u1089\'f1\u1089\'f1\u1077\'e5 \u1089\'f1\u1073\'e1\u1086\'ee\u1088\'f0\u1082\'ea\u1080\'e8}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     PAUSED,         // \u1055\'cf\u1088\'f0\u1080\'e8\u1086\'ee\u1089\'f1\u1090\'f2\u1072\'e0\u1085\'ed\u1086\'ee\u1074\'e2\u1083\'eb\u1077\'e5\u1085\'ed\u1072\'e0 (\u1090\'f2\u1086\'ee\u1074\'e2\u1072\'e0\u1088\'f0\u1072\'e0 \u1085\'ed\u1077\'e5\u1090\'f2)}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     WAITING_CLIENT, // \u1054\'ce\u1078\'e6\u1080\'e8\u1076\'e4\u1072\'e0\u1085\'ed\u1080\'e8\u1077\'e5 \u1088\'f0\u1077\'e5\u1096\'f8\u1077\'e5\u1085\'ed\u1080\'e8\u1103\'ff \u1082\'ea\u1083\'eb\u1080\'e8\u1077\'e5\u1085\'ed\u1090\'f2\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     WAITING_OFFICE, // \u1054\'ce\u1078\'e6\u1080\'e8\u1076\'e4\u1072\'e0\u1085\'ed\u1080\'e8\u1077\'e5 \u1086\'ee\u1073\'e1\u1088\'f0\u1072\'e0\u1073\'e1\u1086\'ee\u1090\'f2\u1082\'ea\u1080\'e8 \u1086\'ee\u1092\'f4\u1080\'e8\u1089\'f1\u1086\'ee\u1084\'ec}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     COMPENSATING,   // \u1042\'c2 \u1087\'ef\u1088\'f0\u1086\'ee\u1094\'f6\u1077\'e5\u1089\'f1\u1089\'f1\u1077\'e5 \u1086\'ee\u1090\'f2\u1082\'ea\u1072\'e0\u1090\'f2\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     COMPLETED,      // \u1059\'d3\u1089\'f1\u1087\'ef\u1077\'e5\u1096\'f8\u1085\'ed\u1086\'ee \u1079\'e7\u1072\'e0\u1074\'e2\u1077\'e5\u1088\'f0\u1096\'f8\u1077\'e5\u1085\'ed\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     CANCELLED,      // \u1054\'ce\u1090\'f2\u1084\'ec\u1077\'e5\u1085\'ed\u1077\'e5\u1085\'ed\u1072\'e0}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0     TIMEOUT         // \u1055\'cf\u1088\'f0\u1086\'ee\u1089\'f1\u1088\'f0\u1086\'ee\u1095\'f7\u1077\'e5\u1085\'ed\u1072\'e0 \u1087\'ef\u1086\'ee \u1090\'f2\u1072\'e0\u1081\'e9\u1084\'ec\u1072\'e0\u1091\'f3\u1090\'f2\u1091\'f3}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql{\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\cf0 \}}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\*\bkmkstart _dx_frag_StartFragment}{\*\bkmkend _dx_frag_StartFragment}{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 9: TransactionService.java =====}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 package com.example.TransactionSaga.service;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import com.example.TransactionSaga.config.SagaProperties;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import org.springframework.beans.factory.annotation.Autowired;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import org.springframework.beans.factory.annotation.Value;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import org.springframework.stereotype.Service;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 @Service}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 public class TransactionService \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Value("$\{saga.retry.max-attempts\}")}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private int maxRetryAttempts;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Value("$\{saga.timeout.default-minutes\}")}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private int defaultTimeoutMinutes;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Value("$\{services.office.url\}")}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private String officeServiceUrl;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Value("$\{services.collector.url\}")}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private String collectorServiceUrl;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private final SagaProperties sagaProperties;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Autowired}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public TransactionService(SagaProperties sagaProperties) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         this.sagaProperties = sagaProperties;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public void someMethod() \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         // \u1048\'c8\u1089\'f1\u1087\'ef\u1086\'ee\u1083\'eb\u1100\'fc\u1079\'e7\u1086\'ee\u1074\'e2\u1072\'e0\u1085\'ed\u1080\'e8\u1077\'e5 \u1079\'e7\u1085\'ed\u1072\'e0\u1095\'f7\u1077\'e5\u1085\'ed\u1080\'e8\u1081\'e9 \u1080\'e8\u1079\'e7 \u1087\'ef\u1088\'f0\u1086\'ee\u1087\'ef\u1077\'e5\u1088\'f0\u1090\'f2\u1080\'e8\u1089\'f1}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         System.out.println("Max retry attempts: " + sagaProperties.getRetry().getMaxAttempts());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         System.out.println("Default timeout: " + sagaProperties.getTimeout().getDefaultMinutes());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         System.out.println("Office service URL: " + officeServiceUrl);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         // \u1048\'c8\u1089\'f1\u1087\'ef\u1086\'ee\u1083\'eb\u1100\'fc\u1079\'e7\u1086\'ee\u1074\'e2\u1072\'e0\u1085\'ed\u1080\'e8\u1077\'e5 @Value \u1085\'ed\u1072\'e0\u1087\'ef\u1088\'f0\u1103\'ff\u1084\'ec\u1091\'f3\u1102\'fe}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         System.out.println("Max retry (via @Value): " + maxRetryAttempts);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 ===== \u1060\'d4\u1040\'c0\u1049\'c9\u1051\'cb 10: SagaOrchestratorService.java =====}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 package com.example.TransactionSaga.service;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import com.example.TransactionSaga.client.ExternalServiceClient;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import com.example.TransactionSaga.model.entity.SagaStepEntity;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import com.example.TransactionSaga.model.entity.TransactionEntity;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import com.example.TransactionSaga.model.enums.TransactionStatus;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import com.example.TransactionSaga.repository.SagaStepRepository;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import com.example.TransactionSaga.repository.TransactionRepository;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import org.slf4j.Logger;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import org.slf4j.LoggerFactory;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import org.springframework.beans.factory.annotation.Autowired;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import org.springframework.scheduling.annotation.Scheduled;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import org.springframework.stereotype.Service;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import org.springframework.transaction.annotation.Transactional;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import java.time.LocalDateTime;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import java.util.Comparator;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import java.util.List;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import java.util.Optional;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 import java.util.stream.Collectors;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 @Service}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 public class SagaOrchestratorService \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private static final Logger log = LoggerFactory.getLogger(SagaOrchestratorService.class);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private final SagaStepRepository sagaStepRepository;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private final TransactionRepository transactionRepository;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private final ExternalServiceClient externalServiceClient;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private final CompensationService compensationService;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Autowired}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public SagaOrchestratorService(}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             SagaStepRepository sagaStepRepository,}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             TransactionRepository transactionRepository,}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             ExternalServiceClient externalServiceClient,}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             CompensationService compensationService) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         this.sagaStepRepository = sagaStepRepository;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         this.transactionRepository = transactionRepository;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         this.externalServiceClient = externalServiceClient;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         this.compensationService = compensationService;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Scheduled(fixedDelay = 30000)}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Transactional}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public void processPendingSteps() \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         List<SagaStepEntity> pendingSteps = sagaStepRepository.findByStatus("PENDING");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         if (pendingSteps.isEmpty()) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             log.debug("No pending steps to process");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             return;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         log.info("Processing \{\} pending saga steps", pendingSteps.size());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         for (SagaStepEntity step : pendingSteps) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             try \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 if (checkDependencies(step)) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     executeStep(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 \} else \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     log.debug("Step \{\} waiting for dependencies", step.getId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             \} catch (Exception e) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 log.error("Failed to execute step \{\}: \{\}", step.getId(), e.getMessage());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 handleStepFailure(step, e.getMessage());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private void executeStep(SagaStepEntity step) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         log.info("Executing step \{\} for transaction \{\}",}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 step.getId(), step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         step.setStatus("IN_PROGRESS");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         step.setStartedAt(LocalDateTime.now());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         sagaStepRepository.save(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         try \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             String stepType = step.getStepType();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             if (stepType == null) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 log.error("Step type is null for step \{\}", step.getId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 step.setStatus("FAILED");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 step.setErrorMessage("Step type is null");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 sagaStepRepository.save(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 return;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             switch (stepType.toUpperCase()) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 case "VALIDATE_ORDER":}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     externalServiceClient.validateOrder(step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     break;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 case "CHECK_STOCK":}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     externalServiceClient.checkStock(step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     break;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 case "NOTIFY_OFFICE":}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     externalServiceClient.notifyOffice(step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     break;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 case "NOTIFY_COLLECTOR":}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     externalServiceClient.notifyCollector(step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     break;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 case "RESERVE_ITEMS":}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     externalServiceClient.reserveItems(step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     break;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 case "CREATE_DELIVERY":}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     createDelivery(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     break;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 case "PROCESS_PAYMENT":}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     processPayment(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     break;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 case "SEND_CONFIRMATION":}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     sendConfirmation(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     break;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 default:}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     log.warn("Unknown step type: \{\}", stepType);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     step.markAsSkipped();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     sagaStepRepository.save(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     return;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             step.setStatus("COMPLETED");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             step.setCompletedAt(LocalDateTime.now());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             sagaStepRepository.save(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             log.info("Step \{\} completed successfully", step.getId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             checkTransactionCompletion(step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \} catch (Exception e) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             log.error("Step execution failed: \{\}", e.getMessage(), e);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             step.setStatus("FAILED");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             step.setErrorMessage(e.getMessage());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             sagaStepRepository.save(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             throw new RuntimeException("Step execution failed: " + e.getMessage(), e);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private void createDelivery(SagaStepEntity step) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         log.info("Creating delivery for transaction: \{\}", step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         externalServiceClient.updateTransactionStatus(step.getTransactionId(), "DELIVERY_CREATED");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private void processPayment(SagaStepEntity step) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         log.info("Processing payment for transaction: \{\}", step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         externalServiceClient.updateTransactionStatus(step.getTransactionId(), "PAYMENT_PROCESSED");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private void sendConfirmation(SagaStepEntity step) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         log.info("Sending confirmation for transaction: \{\}", step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         externalServiceClient.updateTransactionStatus(step.getTransactionId(), "CONFIRMATION_SENT");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private boolean checkDependencies(SagaStepEntity step) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         Long dependsOnStepId = step.getDependsOnStepId();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         if (dependsOnStepId == null) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             return true;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         Optional<SagaStepEntity> dependency = sagaStepRepository.findById(dependsOnStepId);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         if (dependency.isPresent()) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             SagaStepEntity depStep = dependency.get();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             String status = depStep.getStatus();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             return "COMPLETED".equals(status) || "SKIPPED".equals(status);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         return true;}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private void checkTransactionCompletion(String transactionId) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         List<SagaStepEntity> allSteps = sagaStepRepository.findByTransactionId(transactionId);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         boolean allCompleted = allSteps.stream()}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 .allMatch(step -> \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     String status = step.getStatus();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     return "COMPLETED".equals(status) || "SKIPPED".equals(status);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 \});}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         if (allCompleted) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             Optional<TransactionEntity> transactionOpt = transactionRepository.findById(transactionId);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             if (transactionOpt.isPresent()) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 TransactionEntity transaction = transactionOpt.get();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 transaction.setStatus(TransactionStatus.COMPLETED);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 transaction.setCompletedAt(LocalDateTime.now());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 transactionRepository.save(transaction);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 log.info("Transaction \{\} completed successfully", transactionId);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 externalServiceClient.logAuditEvent(transactionId, "TRANSACTION_COMPLETED",}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                         "All saga steps completed successfully");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     private void handleStepFailure(SagaStepEntity step, String error) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         log.error("Handling failure for step \{\}: \{\}", step.getId(), error);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         step.setStatus("FAILED");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         step.setErrorMessage(error);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         sagaStepRepository.save(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         if (step.canRetry()) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             step.incrementRetryCount();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             log.info("Step \{\} scheduled for retry (attempt \{\}/\{\})",}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     step.getId(), step.getRetryCount(), step.getMaxRetries());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \} else \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             compensationService.initiateCompensation(}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     step.getTransactionId(),}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     "STEP_FAILED: " + step.getStepType(),}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     error}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             );}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             Optional<TransactionEntity> transactionOpt = transactionRepository.findById(step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             transactionOpt.ifPresent(transaction -> \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 transaction.setStatus(TransactionStatus.COMPENSATING);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 transactionRepository.save(transaction);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             \});}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             log.error("Step \{\} failed permanently. Compensation initiated.", step.getId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             externalServiceClient.logAuditEvent(step.getTransactionId(), "STEP_FAILED",}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     "Step " + step.getId() + " failed: " + error);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Scheduled(fixedDelay = 60000)}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Transactional}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public void retryFailedSteps() \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         List<SagaStepEntity> failedSteps = sagaStepRepository.findByStatus("FAILED");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         for (SagaStepEntity step : failedSteps) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             if (step.shouldRetryNow()) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 log.info("Retrying failed step \{\} for transaction \{\}",}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                         step.getId(), step.getTransactionId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 step.setStatus("PENDING");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 step.incrementRetryCount();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 sagaStepRepository.save(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Scheduled(fixedDelay = 120000)}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     @Transactional}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public void cleanupCompletedTransactions() \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         List<TransactionEntity> completedTransactions =}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 transactionRepository.findByStatus(TransactionStatus.COMPLETED);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         for (TransactionEntity transaction : completedTransactions) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             LocalDateTime completedAt = transaction.getCompletedAt();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             if (completedAt != null &&}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                     completedAt.plusHours(24).isBefore(LocalDateTime.now())) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 log.info("Archiving old completed transaction: \{\}", transaction.getId());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public void triggerCompensation(String transactionId, String reason, String details) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         log.warn("Manual compensation triggered for \{\}: \{\} - \{\}", transactionId, reason, details);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         compensationService.initiateCompensation(transactionId, reason, details);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public List<SagaStepEntity> getTransactionSteps(String transactionId) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         return sagaStepRepository.findByTransactionId(transactionId).stream()}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 .sorted(Comparator.comparingInt(SagaStepEntity::getStepOrder))}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 .collect(Collectors.toList());}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public SagaStepEntity getStepStatus(Long stepId) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         return sagaStepRepository.findById(stepId)}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 .orElseThrow(() -> new RuntimeException("Step not found: " + stepId));}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public void manuallySkipStep(Long stepId) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         SagaStepEntity step = sagaStepRepository.findById(stepId)}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 .orElseThrow(() -> new RuntimeException("Step not found: " + stepId));}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         String status = step.getStatus();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         if ("PENDING".equals(status) || "FAILED".equals(status)) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             step.markAsSkipped();}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             sagaStepRepository.save(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             log.info("Step \{\} manually skipped", stepId);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \} else \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2             throw new RuntimeException("Cannot skip step in status: " + status);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     public void resetStep(Long stepId) \{}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         SagaStepEntity step = sagaStepRepository.findById(stepId)}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2                 .orElseThrow(() -> new RuntimeException("Step not found: " + stepId));}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         step.setStatus("PENDING");}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         step.setRetryCount(0);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         step.setNextRetryTime(null);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         step.setErrorMessage(null);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         sagaStepRepository.save(step);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2         log.info("Step \{\} reset to PENDING", stepId);}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql\tx916\tx1832\tx2748\tx3664\tx4580\tx5496\tx6412\tx7328\tx8244\tx9160\tx10076\tx11908\tx12824\tx13740\tx14656{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2     \}}\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2\par\pard\plain\ql{\fcs1\af5\ltrch\fcs0\hich\af5\dbch\af5\loch\f5\fs20\cf2 \}}{\*\bkmkstart _dx_frag_EndFragment}{\*\bkmkend _dx_frag_EndFragment}\fcs1\af1\ltrch\fcs0\hich\af2\dbch\af3\loch\f2\fs24\par{\*\themedata 
504b03041400020008000000210201159325ae000000270100000b0000005f72656c732f2e72656c738d8f310ec2300c45af1279a76e1910424dbbb07460415c204a9d34a24da224457036068ec415c8d82206164b5ffe7efffbfd7cd5ed7d1ad98d4234
ce72a88a121859e97a63358739a9cd1edaa63ed3285276c4c1f8c8f2898d1c8694fc0131ca8126110be7c9e68d72611229cba0d10b79159a705b963b0c4b06ac99aceb3984aeaf805d1e9efe613ba58ca4a393f34436fd88f87264b2089a12879499848b
791236b70c454e00864d8dab779b0f504b0304140002000800000021027f624aeb730000007b0000001c0000007468656d652f7468656d652f7468656d654d616e616765722e786d6c0d8cc10d83300c005789fc2f4e7954554460820e61810991888392
b465b73e3a5257a89fa7d3ddeff31da633ede6c5a5c62c1eae9d05c332e7254af0f06cebe50ed338906b1b277e9050e062b491eac8c3d6dae110ebac966a970f16756b2e899a6209b8147aeb2bedd85b7bc34451c0e0f807504b03041400020008000000
21020a5d705ea60000000c010000270000007468656d652f7468656d652f5f72656c732f7468656d654d616e616765722e786d6c2e72656c738dcf3d0ec2300c05e0ab44dea95b068450d32e2c5d11178852278d687e94a408cec6c091b8021113951818
9fecf7597e3d9e6d7fb333bb524cc63b0e4d55032327fd689ce6b064b5d943dfb5279a452e1b693221b1527189c39473382026399115a9f2815c99281fadc825468d41c88bd084dbbade61fc36606db261e41087b10176be07fac7f64a1949472f174b2e
ff3881b974a980226aca1c3eb1a90a030cbb16573f756f504b0304140002000800000021026d52debf9f050000fd1b0000160000007468656d652f7468656d652f7468656d65312e786d6ced594f6fdb3614ff2a84eead2c5b729da06e113b76bb356983
c4ebd0232dd3126b4a14483aa96f437b1c30605837ec3260b71d866d015a608765d887c9d661eb807c8551b42c5136d5244d566c587cb045eaf7deeffde17b22e5939f7eb979fb4944c03e621cd3b86d39d76b1640b14f47380edad6548cafb5acdbb76e
c27511a20801098ef93a6c5ba110c9ba6d735f4e437e9d262896f7c6944550c8210bec118307524944ec7aadd6b42388630bc430426debc1788c7d0406a94a2b57de23f22b163c9df009dbf315a32ea1b0a38993fef019ef1206f621695b9267440f06e8
89b000815cc81b6daba63e16b06fddb47329222a8435c1befa2c043389d1a4ae045930cc259dbebb7663b360a8cf195681bd5eafdb730a8d0a017d5f7aebac80dd7ecbe9e45a35d4fc72557bb7e6d5dc25018da1b122b0d6e974bcb5b240a3107057045a
b5a6bb512f0bb88580b7ea4367a3db6d9605bc42a0b922d0bfb1d6749704142a24389eacc0d3cc1629ca31634aee1af12d896fe56ba180d9da4a9b2b8845d5ba8be063cafa12a0b20c058e819825680c7d89ebc268c830540c701d41ed5636e7f3d5b994
0e709fe144b4adf713280ba4c09c1c7d7772f4029c1c1d1e3f7d79fcf4c7e367cf8e9ffe6092bc0be340977cfdcda77f7df511f8f3c5d7af9f7f5e21c07581dfbefff8d79f3fab400a1df9ea8bc3df5f1ebefaf2933fbe7d6ec26f3038d4f1031c210eee
a303b04ba3d43f03051ab2738a0c42884b2230945013b227c212f2fe0c1223b083ca317cc8645b3022ef4c1f97ecdd0bd9546013f25e189590db94920e65669fee293acda7691c54f0b3a90edc8570df48df5dca726f9ac8958d8d4abb212a99ba4364e2
61806224407a8f4e1032c93dc2b814df6dec33cae95880471874203607668087c22c751747324133a38d32eba5086d3f041d4a8c049b68bf0c95150289512922a568de81530123b3d530223a740b8ad068e8de8cf9a5c07321931e2042416f8438370a3d
60b392c9f7a06c51e615b04d665119ca049e18a15b90521dba4927dd104689d96e1c873af83d3e912b16821d2acc76d072cda4639910185767fe2146e29cc5fe010e42f36249ef4c99b146102dd7e88c8c218a170f80522b8f70fca6be4eb06cec577d7d
a9af6fc8879db19e96bb7925f03fdac337e134de41699d5cb5f0ab167ed5c2df50e1ff44e32e7ab5adefd6959ea872eb3ec684ec8919415b5c75792e5d1cf5e5a41a28a1fca89084f272c15702060caa6bc0a8f8108b702f8489e4711445c033dd010709
e5f28862552a57275e2cbd56735e7e4c957028b6e9683edf289d5f73456a14709daa91aa382b5de3c645e99c39f28c7c8e57c1e7bd99cfd6622acb08c0f47d84d3ac6766721f12344aa33f572d3041bbc81799be45ae2e3d6f3c84239425ce317be634ce
1ac9d6e981d4f8d61a17e53b4be67442b78ad0bb8cd4d54e4b9dbd5ab9242e8fc08134d3ab7b16f0a344eae4693b832488db962f32874e2df665b72b56ac53ab76bb4492302e36210fe762ea56feee272eecae7b6eaaee02869bbad419c91b2de7dd93db
cb0944e3b14c7cc54c31cceed1a9406c2f1c1d802199b25d282d77e74b6a84b97c78d41703268bd3cd565bb9e8b3c5bffc2e292b0a48921066eda9a5e77a8e57d7b9116aa4d9675718ff96be342ed117efffec4bba7ce526b83152a735b9356010a4ebb4
6d5126422adb4d1262bfcfe466429149c3803c06aafe44d277e2a9b1687fd1afec859279770b42b18b03c0b06c71226408ed88ccd353b4398b76989547a629eb2db9c13c99ff0ed13e2283b4729b69082c10e60d248b85022e27ce36d5d830e8ff9b3744
6ed586e8941d4341e59e6783e2eaed5e7b0aac5dd48a733e6deb156ed7bdb33f6d13799e01e9976ce498f9a4d8fe0ea87ac416fb4db924afb5b252cc2787d2ea96ee5faaeb5d6eaf8ab4b4aa56c1a5ee53b5f837aae27f0ae1dbc7df3384df3b57f4edd5
62b6b593901a2dfdb7b698b9f537504b030414000200080000002102e9278183ee00000010020000130000005b436f6e74656e745f54797065735d2e786d6cad914d4ec3301085af62795bc54e5920849274012cf959708191334e2ce21fd993aa9c8d05
47e20a4cd382102a48486c2cd9efcdfb66c66f2fafcd66e727b1c55c5c0cad5cab5a0a0c26f62e0cad9cc9561772d3358fcf098b606b28ad1c89d2a5d6c58ce8a1a89830b06263f6407ccd834e609e60407d56d7e7dac44018a8a27d86ec9a6bb4304f24
6e76fc7cc0669c8a145707e39ed54a486972068875bd0dfd374a752428ae5c3c6574a9acd820853e8958a41f091f85f7bc89ec7a140f90e90e3cdb34f198f8f55cabdfc34eb41bad7506fb6866cf256a8959fd097a0b81e7cdff833e867d76a097ffedde
01504b010214001400020008000000210201159325ae000000270100000b00000000000000000000000000000000005f72656c732f2e72656c73504b01021400140002000800000021027f624aeb730000007b0000001c00000000000000000000000000
d70000007468656d652f7468656d652f7468656d654d616e616765722e786d6c504b01021400140002000800000021020a5d705ea60000000c0100002700000000000000000000000000840100007468656d652f7468656d652f5f72656c732f7468656d
654d616e616765722e786d6c2e72656c73504b01021400140002000800000021026d52debf9f050000fd1b000016000000000000000000000000006f0200007468656d652f7468656d652f7468656d65312e786d6c504b01021400140002000800000021
02e9278183ee000000100200001300000000000000000000000000420800005b436f6e74656e745f54797065735d2e786d6c504b050600000000050005005d010000610900000000}{\*\colorschememapping 3c3f786d6c2076657273696f6e3d22312e
302220656e636f64696e673d227574662d38223f3e3c613a636c724d617020786d6c6e733a613d22687474703a2f2f736368656d61732e6f70656e786d6c666f726d6174732e6f72672f64726177696e676d6c2f323030362f6d61696e22206267313d22
6c743122207478313d22646b3122206267323d226c743222207478323d22646b322220616363656e74313d22616363656e74312220616363656e74323d22616363656e74322220616363656e74333d22616363656e74332220616363656e74343d226163
63656e74342220616363656e74353d22616363656e74352220616363656e74363d22616363656e74362220686c696e6b3d22686c696e6b2220666f6c486c696e6b3d22666f6c486c696e6b22202f3e}}